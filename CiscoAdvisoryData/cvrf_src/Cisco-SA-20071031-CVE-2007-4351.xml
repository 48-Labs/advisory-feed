<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>Cisco-SA-20071031-CVE-2007-4351</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>11.0</cvrf:Version>
    <cvrf:RevisionHistory />
    <cvrf:InitialReleaseDate>2007-10-31T17:40:08</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-07-14T19:36:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">The Common UNIX Printing System (CUPS) versions 1.3.3 and prior contain a vulnerability that can allow an unauthenticated, remote attacker to create a denial of service (DoS) condition or execute arbitrary code with the privileges of the user.

The vulnerability exists in the ippReadIO() function when processing Internet Printing Protocol (IPP) tags.  The function causes an off-by-one error when allocating space.  An unauthenticated, remote attacker could send a request with crafted tags to overwrite one byte on the stack with a zero.  The attacker could crash the daemon or possibly execute arbitrary code.

The vendor has confirmed this vulnerability in release notes and released an updated version.





The vulnerability requires the attacker to connect to the IPP TCP port to perform an attack.  However, the default configuration of CUPS does not allow remote hosts to connect to this port.  This configuration should mitigate the potential for this attack.  IT departments that deploy and use CUPS without changing the default configuration may not be at risk.

The severity of the impact will vary depending on the system on which CUPS is deployed.  If this system is used for multiple services, a DoS condition could cause other services besides the CUPS service to crash, which may affect other users and departments.  

If code execution is accomplished, it will most likely be in the context of the CUPS user.  This user probably has limited privileges.
</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">CUPS has provided release notes at the following link: CUPS 1.3.4["http://www.cups.org/relnotes.php"] 

Apple has released a security update at the following link: Security Update 2007-009["http://docs.info.apple.com/article.html?artnum=307179"] 

Avaya has released a security advisory at the following link: ASA-2007-476["http://support.avaya.com/elmodocs2/security/ASA-2007-476.htm"] 

Cisco has released a security response to address Cisco bug ID CSCsl92095["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCsl92095"] at the following link: cisco-sa-20080625-waas["http://www.cisco.com/en/US/products/products_security_response09186a00809a1f11.html"] 

Debian has released a security advisory at the following link: DSA-1407-1["http://www.us.debian.org/security/2007/dsa-1407"] 

FreeBSD has released a VuXML document at the following link: cups -- off-by-one buffer overflow["http://www.vuxml.org/freebsd/8dd9722c-8e97-11dc-b8f6-001c2514716c.html"] 

Gentoo has released a security advisory at the following link: GLSA 200711-16["http://www.gentoo.org/security/en/glsa/glsa-200711-16.xml"] 

Mandriva has released security advisories at the following links: MDKSA-2007:204["http://www.mandriva.com/en/security/advisories?name=MDKSA-2007:204"] and MDKSA-2007:204-1["http://www.mandriva.com/en/security/advisories?name=MDKSA-2007:204-1"] 

Red Hat has released security advisories at the following links: RHSA-2007:1020["http://rhn.redhat.com/errata/RHSA-2007-1020.html"], RHSA-2007:1022["http://rhn.redhat.com/errata/RHSA-2007-1022.html"], and RHSA-2007:1023["http://rhn.redhat.com/errata/RHSA-2007-1023.html"]

Slackware has released a security advisory at the following link: SSA:2007-305-01["http://www.slackware.com/lists/archive/viewer.php?l=slackware-security&amp;y=2007&amp;m=slackware-security.501902"]

SUSE has released a security announcement at the following link: SUSE-SA:2007:058["http://www.novell.com/linux/security/advisories/2007_58_cups.html"] 

Turbolinux has released a security advisory at the following link: TLSA-2008-19["http://www.turbolinux.com/security/2008/TLSA-2008-19.txt"] 

Ubuntu has released a security notice at the following link: USN-539-1["http://www.ubuntu.com/usn/usn-539-1"] 

US-CERT has released a vulnerability note at the following link: VU#446897["http://www.kb.cert.org/vuls/id/446897"]
</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">CUPS versions 1.3.3 and prior are vulnerable.
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">No other Cisco products are currently known to be affected by these vulnerabilities.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">Administrators are advised to apply the appropriate update.

Administrators are advised to restrict access to trusted users.

The Cisco Applied Intelligence team has created the following companion document to guide administrators in identifying and mitigating attempts to exploit this vulnerability prior to applying updated software: Identifying and Mitigating Exploitation of the Wide Area Application Services Common UNIX Printing System Vulnerability["http://www.cisco.com/en/US/products/products_applied_mitigation_bulletin09186a00809a1f19.html"] 
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">An updated version of CUPS is available at the following link: CUPS 1.3.4["http://www.cups.org/software.php?VERSION=1.3.4"] 

Apple has released updated software at the following links: 


Security Update 2007-009 (10.4.11 Universal)["http://support.apple.com/kb/index?page=answerlink&amp;url=http%3A%2F%2Fwww.apple.com%2Fsupport%2Fdownloads%2Fsecurityupdate20070091110411universal.html&amp;answerid=16777216&amp;src=support_site.kbase"] 
Security Update 2007-009 (10.4.11 PPC)["http://support.apple.com/kb/index?page=answerlink&amp;url=http%3A%2F%2Fwww.apple.com%2Fsupport%2Fdownloads%2Fsecurityupdate20070091110411ppc.html&amp;answerid=16777216&amp;src=support_site.results.search"] 
Security Update 2007-009 (10.5.1)["http://support.apple.com/kb/index?page=answerlink&amp;url=http%3A%2F%2Fwww.apple.com%2Fsupport%2Fdownloads%2Fsecurityupdate2007009111051.html&amp;answerid=16777216&amp;src=support_site.results.search"] 

Cisco customers with active contracts can obtain updates through the Software Center at the following link: Cisco["http://www.cisco.com/public/sw-center/"]. Cisco customers without contracts can obtain upgrades by contacting the Cisco Technical Assistance Center at 1-800-553-2447 or 1-408-526-7209 or via e-mail at tac@cisco.com["mailto:tac@cisco.com"].

Debian has released updated packages at the following link: Debian["http://www.us.debian.org/security/2007/dsa-1407"] 

FreeBSD releases ports collection updates at the following link: Ports Collection Index["http://www.freebsd.org/ports/master-index.html"] 




Gentoo updates can be obtained for the following package using the emerge command: net-print/cups 


Mandriva can be updated automatically using MandrivaUpdate.

Red Hat packages can be updated using the up2date command.

Slackware packages can be updated using the upgradepkg command.

SUSE has released updated packages; users can install the updates using YaST.

Turbolinux packages can be updated using the turbopkg command. 

Ubuntu has released updated packages; users can install the updates using Update Manager.
</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="9">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20071031-CVE-2007-4351</cvrf:URL>
      <cvrf:Description>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Wide Area Application Services (WAAS)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7367">Cisco Wide Area Application Services (WAAS) </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</Title>
    <CVE>CVE-2007-4351</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-7367</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>6.4</BaseScoreV2>
        <TemporalScoreV2>4.7</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:P/A:P/E:U/RL:OF/RC:C/CDP:N/TD:N/CR:ND/IR:ND/AR:ND</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>Administrators are advised to apply the appropriate update.

Administrators are advised to restrict access to trusted users.

The Cisco Applied Intelligence team has created the following companion document to guide administrators in identifying and mitigating attempts to exploit this vulnerability prior to applying updated software: Identifying and Mitigating Exploitation of the Wide Area Application Services Common UNIX Printing System Vulnerability["http://www.cisco.com/en/US/products/products_applied_mitigation_bulletin09186a00809a1f19.html"] 
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20071031-CVE-2007-4351</URL>
        <Description>Common UNIX Printing System IPP Tags Memory Corruption Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
