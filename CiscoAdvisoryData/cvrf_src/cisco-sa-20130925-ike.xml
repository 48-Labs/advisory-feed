<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco IOS Software Internet Key Exchange Memory Leak Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20130925-ike</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2013-09-24T16:23:42</cvrf:Date>
        <cvrf:Description>Initial public release</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2013-09-25T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2013-09-25T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the Internet Key Exchange (IKE) protocol of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to cause a memory leak that could lead to a device reload.



The vulnerability is due to incorrect handling of malformed IKE packets by the affected software. An attacker could exploit this vulnerability by sending crafted IKE packets to a device configured with features that leverage IKE version 1 (IKEv1).



Although IKEv1 is automatically enabled on a Cisco IOS Software and Cisco IOS XE Software when IKEv1 or IKE version 2 (IKEv2) is configured, the vulnerability can be triggered only by sending a malformed IKEv1 packet.



In specific conditions, normal IKEv1 packets can also cause an affected release of Cisco IOS Software to leak memory.



Only IKEv1 is affected by this vulnerability.



An exploit could cause Cisco IOS Software not to release allocated memory, causing a memory leak. A sustained attack may result in a device reload.



Cisco has released software updates that address this vulnerability. There are no workarounds to mitigate this vulnerability. 

This advisory is available at the following link:

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-ike["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-ike"]

Note: The September 25, 2013, Cisco IOS Software Security Advisory bundled publication includes eight Cisco Security Advisories. All advisories address vulnerabilities in Cisco IOS Software. Each Cisco IOS Software Security Advisory lists the Cisco IOS Software releases that correct the vulnerability or vulnerabilities detailed in the advisory as well as the Cisco IOS Software releases that correct all Cisco IOS Software vulnerabilities in the September 2013 bundled publication. 

Individual publication links are in "Cisco Event Response: Semiannual Cisco IOS Software Security Advisory Bundled Publication" at the following link: 

http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep13.html["http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_sep13.html"]

</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2" />
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">Although only IKEv1 packets can be used to trigger this vulnerability, devices that are running Cisco IOS Software or Cisco IOS XE Software are vulnerable when they are configured to use IKEv1 or IKEv2.



Configuring IKEv2 on Cisco IOS Software or Cisco IOS XE Software automatically enables IKEv1.



A number of features use IKEv1, including different types of VPNs such as the following:





    LAN-to-LAN VPN 
    Remote access VPN (excluding SSLVPN) 
    Dynamic Multipoint VPN (DMVPN) 
    Group Domain of Interpretation (GDOI) 



The preferred method to determine whether a device has been configured for IKE is to issue the show ip sockets or show udp EXEC command. If the device has UDP port 500, UDP port 4500, or UDP port 848 open, it is processing IKE packets.





In the following example, the device is processing IKE packets in UDP port 500 and UDP port 4500, using either IP version 4 (IPv4) or IP version 6 (IPv6):







router# show udp 
Proto        Remote      Port      Local       Port  In Out  Stat TTY OutputIF  
17       --listen--          192.168.130.21    500   0   0 1001011   0   
17(v6)   --listen--          UNKNOWN           500   0   0 1020011   0   
17       --listen--          192.168.130.21   4500   0   0 1001011   0   
17(v6)   --listen--          UNKNOWN          4500   0   0 1020011   0  
!--- Output truncated 
router#



To determine the Cisco IOS Software release that is running on a Cisco product, administrators can log in to the device and issue the show version command to display the system banner. The system banner confirms that the device is running Cisco IOS Software by displaying text similar to "Cisco Internetwork Operating System Software" or "Cisco IOS Software." The image name displays in parentheses, followed by "Version" and the Cisco IOS Software release name. Other Cisco devices do not have the show version command or may provide different output.

The following example identifies a Cisco product that is running Cisco IOS Software Release 15.0(1)M1 with an installed image name of C3900-UNIVERSALK9-M:

Router&gt; show version 
Cisco IOS Software, C3900 Software (C3900-UNIVERSALK9-M), Version 15.0(1)M1, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2009 by Cisco Systems, Inc.
Compiled Wed 02-Dec-09 17:17 by prod_rel_team
!--- output truncated 
Additional information about Cisco IOS Software release naming conventions is available in "White Paper: Cisco IOS and NX-OS Software Reference Guide" at http://www.cisco.com/web/about/security/intelligence/ios-ref.html["http://www.cisco.com/web/about/security/intelligence/ios-ref.html"]. 

</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">Cisco IOS XR Software is not affected by this vulnerability.



Cisco ASA 5500 Series Adaptive Security Appliance is not affected by this vulnerability.



 No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">The IKE protocol is used in the IP Security (IPsec) protocol suite to negotiate cryptographic attributes that will be used to encrypt or authenticate the communication session. These attributes include cryptographic algorithm, mode, and shared keys. The result of IKE is a shared session secret that will be used to derive cryptographic keys.



 Cisco IOS Software or Cisco IOS XE Software support IKE for IPv4 and IPv6 communications.  IKE communication can use any of the following UDP ports:




    UDP port 500 
    UDP port 4500, Network Address Translation (NAT) Traversal (NAT-T) 
    UDP port 848,  Group Domain of Interpretation (GDOI) 

A vulnerability in the Internet Key Exchange (IKE) protocol of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to cause a memory leak that could lead to a device reload.



The vulnerability is due to incorrect handling of malformed IKE packets by the affected software. An attacker could exploit this vulnerability by sending crafted IKE packets to a device configured with features that leverage IKE version 1 (IKEv1).



Although IKEv1 is automatically enabled on a Cisco IOS Software and Cisco IOS XE Software when IKEv1 or IKE version 2 (IKEv2) is configured, the vulnerability can be triggered only by sending a malformed IKEv1 packet.



In specific conditions, normal IKEv1 packets can also cause an affected release of Cisco IOS Software to leak memory.



Only IKEv1 is affected by this vulnerability.



An exploit could cause Cisco IOS Software not to release allocated memory, causing a memory leak. A sustained attack may result in a device reload.

An attacker could exploit this vulnerability using either IPv4 or IPv6 on any of the listed UDP ports. 




How to Determine Whether the Vulnerability Has Been Exploited
To determine whether the vulnerability has been exploited on an affected device, issue the show memory debug leaks summary command from the command-line interface.



The following example shows the output of an affected Cisco IOS or Cisco IOS XE device where there are observed memory leaks in IKE FSM CONTEXT: 




Router#show memory debug leaks summary
Adding blocks for GD...

                 I/O memory                 
Alloc PC        Size     Blocks      Bytes    What

                 Processor memory                 
Alloc PC        Size     Blocks      Bytes    What

0x651A3D38 0000000092 0000000005 0000000460    IKE FSM CONTEXT
0x651A3D38 0000000104 0000000002 0000000208    IKE FSM CONTEXT
0x651A3D38 0000000112 0000000002 0000000224    IKE FSM CONTEXT
0x651A3D38 0000000156 0000000002 0000000312    IKE FSM CONTEXT


Note: The show memory debug leaks summary command may be CPU intensive and should be used with caution.



This vulnerability is documented in Cisco bug ID CSCtx66011["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtx66011"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2013-5473.


</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">There are no workarounds for this vulnerability.



The following identification mechanism exists for this vulnerability.

Embedded Event Manager (EEM)
A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect a memory leak that is caused by this vulnerability. The policy allows administrators to monitor the memory for the affected process on a Cisco IOS device. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade or reload the device to recover the lost memory at a suitable time. The example policy is based on a Tcl script that sends a syslog message when the memory keeps dropping and reaches EEM_IKE_BUFF_INCR_THRES and when the IKE buffers have dropped EEM_IKE_BUFF_INCR_THRES times. If IKE buffers are freed the counter starts counting from zero. After generating the memory leak syslog message the script re-initializes. 

The Tcl script is available for download in Cisco Beyond: Embedded Event Manager (EEM) Scripting Community["https://supportforums.cisco.com/docs/DOC-30300"].



 A sample device configuration follows:






event manager environment EEM_MEM_LEAK_INTERVAL 20
event manager environment EEM_MEM_LEAK_MAX_RUNTIME 5
event manager environment EEM_IKE_BUFF_INCR_THRES 3
event manager environment EEM_FREE_MEMORY_THRES 70
event manager directory user policy "flash:/"
event manager policy eem_ike_mem_leak.tcl

</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">When considering software upgrades, customers are advised to consult the Cisco Security Advisories, Responses, and Notices archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution. 

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 

Cisco IOS Software
Each row of the following Cisco IOS Software table corresponds to a Cisco IOS Software train. If a particular train is vulnerable, the earliest releases that contain the fix are listed in the First Fixed Release column. The First Fixed Release for All Advisories in the September 2013 Bundled Publication column lists the earliest possible releases that correct all the published vulnerabilities in the Cisco IOS Software Security Advisory bundled publication. Cisco recommends upgrading to the latest available release where possible.

The Cisco IOS Software Checker allows customers to search for Cisco Security Advisories that address specific Cisco IOS Software releases. This tool is available on the Cisco Security (SIO) portal at https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x["https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x"] 



    
        
            Major Release
                 Availability of Repaired Releases
        
        
            Affected 12.0-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            There are no affected 12.0 based releases
        
        
            Affected 12.2-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            12.2EX
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.0SE["#15_0SE"]

            
        
        
            12.2EY
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.2S["#15_2S"]

            
        
        
            12.2EZ
            Not vulnerable

            
            Releases prior to 12.2(60)EZ2 are vulnerable; Releases 12.2(60)EZ2 and later are not vulnerable. First fixed in Release 15.0SE["#15_0SE"]

            
        
        
            12.2IRB
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2IRC
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2IRD
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2IRE
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2IRF
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2IRG
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2IRH
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2IRI
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2IXG
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2IXH
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2MC
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.1M["#15_1M"]

            
        
        
            12.2MRA
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2MRB
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SB
            Not vulnerable

            
            12.2(33)SB15

            
        
        
            12.2SCA
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCB
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCC
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCD
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCE
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCF
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCG
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SCH["#12_2SCH"]

            
        
        
            12.2SCH
            Not vulnerable

            
            12.2(33)SCH1

            
        
        
            12.2SE
            Not vulnerable

            
            12.2(55)SE8

            
        
        
            12.2SEG
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.0SE["#15_0SE"]

            
        
        
            12.2SG
            Not vulnerable

            
            

            12.2(53)SG10; available December 2013 * ["#ios_note_1"]

            
        
        
            12.2SGA
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SM
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SQ
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SRA
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2SRB
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2SRC
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2SRD
            Not vulnerable

            
            Vulnerable; First fixed in Release 12.2SRE["#12_2SRE"]

            
        
        
            12.2SRE
            Not vulnerable

            
            12.2(33)SRE9

            
        
        
            12.2STE
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SV
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SVD
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SVE
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2SW
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.1M["#15_1M"]

            
        
        
            12.2SXF
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory. 

            
        
        
            12.2SXH
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory. 

            
        
        
            12.2SXI
            Not vulnerable

            
            12.2(33)SXI12

            
        
        
            12.2SXJ
            Not vulnerable

            
            12.2(33)SXJ6

            
        
        
            12.2SY
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.0SY["#15_0SY"]

            
        
        
            12.2WO
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2XNA
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XNB
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XNC
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XND
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XNE
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XNF
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
            Please see Cisco IOS XE Software Availability["#iosxe"]

            
        
        
            12.2XO
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            12.2ZYA
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            Affected 12.3-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            There are no affected 12.3 based releases
        
        
            Affected 12.4-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            There are no affected 12.4 based releases
        
        
            Affected 15.0-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            There are no affected 15.0 based releases
        
        
            Affected 15.1-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            15.1EY
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.2S["#15_2S"]

            
        
        
            15.1GC
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.1M["#15_1M"]

            
        
        
            15.1M
            15.1(4)M5

            
            15.1(4)M7

            
        
        
            15.1MR
            Releases up to and including 15.1(1)MR4 are not vulnerable. 

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.1MRA
            Not vulnerable

            
            15.1(3)MRA2

            
        
        
            15.1S
            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]

            
            15.1(3)S6

            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]
        
        
            15.1SG
            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]

            
            15.1(2)SG1

            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]
        
        
            15.1SNG
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.1SNH
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.1SNI
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.1SVD
            Not vulnerable

            
            Not vulnerable

            
        
        
            15.1SVE
            Not vulnerable

            
            Not vulnerable

            
        
        
            15.1SVF
            Not vulnerable

            
            Not vulnerable

            
        
        
            15.1SY
            Not vulnerable

            
            

            15.1(1)SY2; Available on 28-OCT-13 

            15.1(2)SY
        
        
            15.1T
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.1M["#15_1M"]

            
        
        
            15.1XO
            Not vulnerable

            
            Not vulnerable

            
        
        
            Affected 15.2-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            15.2E
            Not vulnerable

            
            Not vulnerable

            
        
        
            15.2GC
            15.2(3)GC1

            15.2(4)GC

            
            Vulnerable; migrate to any release in 15.4T

            
        
        
            15.2JA
            Not vulnerable

            
            15.2(4)JA1

            
        
        
            15.2JAX
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.2JB
            Not vulnerable

            
            15.2(2)JB2

            
        
        
            15.2JN
            Not vulnerable

            
            Not vulnerable

            
        
        
            15.2M
            Not vulnerable

            
            15.2(4)M4

            
        
        
            15.2S
            15.2(4)S

            

            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]

            
            15.2(4)S4 

            Cisco IOS XE devices: Please see Cisco IOS XE Software Availability["#iosxe"]
        
        
            15.2SA
            Not vulnerable

            
            15.2(2)SA

            
        
        
            15.2SNG
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.2SNH
            Not vulnerable

            
            Vulnerable; contact your support organization per the instructions in Obtaining Fixed Software["#fixes"] section of this advisory.

            
        
        
            15.2SNI
            Not vulnerable

            
            Vulnerable; First fixed in Release 15.3S["#15_3S"]

            
        
        
            15.2T
            15.2(3)T3

            
            15.2(3)T4

            
        
        
            Affected 15.3-Based Releases
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            There are no affected 15.3 based releases
        
    



* Cisco Catalyst 4500 Series Switches with Cisco Catalyst 4500 Supervisor Engines 6-E or 6L-E can migrate to Cisco IOS Software Release 15.1SG["http://www.cisco.com/en/US/docs/switches/lan/catalyst4500/release/note/OL_27990-01.html#wp2646498"].



 

Cisco IOS XE Software
For a mapping of Cisco IOS XE Software releases to Cisco IOS Software releases, refer to Cisco IOS XE 2 Release Notes["http://www.cisco.com/en/US/docs/ios/ios_xe/2/release/notes/rnasr21.html#wp2310700"], Cisco IOS XE 3S Release Notes["http://www.cisco.com/en/US/docs/ios/ios_xe/3/release/notes/asr1k_rn_3s_sys_req.html#wp2999052"], and Cisco IOS XE 3SG Release Notes["http://www.cisco.com/en/US/docs/switches/lan/catalyst4500/release/note/OL_24726.html#wp2570252"].




    
        
            Cisco IOS XE Software Release
            First Fixed Release
            First Fixed Release for All Advisories in the September 2013 Cisco IOS Software Security Advisory Bundled Publication
        
        
            2.1.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            2.2.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            2.3.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            2.4.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            2.5.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            2.6.x
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            3.1.xS
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            3.1.xSG
            Not vulnerable
            Vulnerable; migrate to 3.4.1SG or later.
        
        
            3.2.xS
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            3.2xSE
            Not vulnerable
            3.2.3SE
        
        
            3.2.xSG
            Not vulnerable
            Vulnerable; migrate to 3.4.1SG or later.
        
        
            3.2.xXO
            Not vulnerable
            Vulnerable; migrate to 3.3.0XO or later.
        
        
            3.2.xSQ
            Not vulnerable
            Vulnerable; migrate to 3.3.0SQ or later.
        
        
            3.3.xS
            Not vulnerable
            Vulnerable; migrate to 3.4.6S or later.
        
        
            3.3xSG
            Not vulnerable
            Vulnerable; migrate to 3.4.1SG or later.
        
        
            3.3xXO
            Not vulnerable
            Not vulnerable
        
        
            3.3xSQ
            Not vulnerable
            Not vulnerable
        
        
            3.4.xS
            Only releases 3.4.2S through 3.4.5S are vulnerable.
            3.4.6S
        
        
            3.4.xSG
            Not vulnerable
            3.4.1SG*["#iosxe_note_1"]
        
        
            3.5.xE 
            Not vulnerable
            Not vulnerable
        
        
            3.5.xS
            Not vulnerable
            Vulnerable; migrate to 3.7.4S or later.
        
        
            3.6.xS
            3.6.1S
            Vulnerable; migrate to 3.7.4S or later.
        
        
            3.7.xS
            Not vulnerable
            3.7.4S
        
        
            3.8.xS
            Not vulnerable
            Vulnerable; migrate to 3.9.2S or later.
        
        
            3.9.xS
            Not vulnerable
            3.9.2S
        
        
            3.10.xS
            Not vulnerable
            Not vulnerable
        
    



* Cisco Catalyst 4500 Series Switches with Cisco Catalyst 4500 Supervisor Engines 7-E and 7L-E and Cisco Catalyst 4500-X Series Switches can migrate to Cisco IOS XE Software Release 3.4SG["http://www.cisco.com/en/US/docs/switches/lan/catalyst4500/release/note/OL_27989-01.html#wp2691896"].



Cisco IOS XR Software
Cisco IOS XR Software is not affected by any of the vulnerabilities that are disclosed in the September 2013 Cisco IOS Software Security Advisory Bundled Publication. 





</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 

This vulnerability was discovered during resolution of a support case.
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-ike</cvrf:URL>
      <cvrf:Description>Cisco IOS Software Internet Key Exchange Memory Leak Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Type="Vendor" Name="Cisco">
      <Branch Type="Product Name" Name="IOS">
        <Branch Type="Product Version" Name="15.1XB">
          <Branch Type="Service Pack" Name="15.1(4)XB7">
            <FullProductName ProductID="CVRFPID-114012">Cisco IOS 15.1(4)XB7</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(4)XB8">
            <FullProductName ProductID="CVRFPID-115982">Cisco IOS 15.1(4)XB8</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(4)XB8a">
            <FullProductName ProductID="CVRFPID-116254">Cisco IOS 15.1(4)XB8a</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.2S">
          <Branch Type="Service Pack" Name="15.2(2)S">
            <FullProductName ProductID="CVRFPID-107861">Cisco IOS 15.2(2)S</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1S">
          <Branch Type="Service Pack" Name="15.1(3)S2">
            <FullProductName ProductID="CVRFPID-111552">Cisco IOS 15.1(3)S2</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)S4">
            <FullProductName ProductID="CVRFPID-111553">Cisco IOS 15.1(3)S4</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)S3">
            <FullProductName ProductID="CVRFPID-111558">Cisco IOS 15.1(3)S3</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)S5">
            <FullProductName ProductID="CVRFPID-184123">Cisco IOS 15.1(3)S5</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)S5a">
            <FullProductName ProductID="CVRFPID-190983">Cisco IOS 15.1(3)S5a</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1M">
          <Branch Type="Service Pack" Name="15.1(4)M3">
            <FullProductName ProductID="CVRFPID-105332">Cisco IOS 15.1(4)M3</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(4)M4">
            <FullProductName ProductID="CVRFPID-108614">Cisco IOS 15.1(4)M4</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(4)M3a">
            <FullProductName ProductID="CVRFPID-114167">Cisco IOS 15.1(4)M3a</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.2GC">
          <Branch Type="Service Pack" Name="15.2(3)GC">
            <FullProductName ProductID="CVRFPID-116726">Cisco IOS 15.2(3)GC</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVR">
          <Branch Type="Service Pack" Name="15.1(3)SVR1">
            <FullProductName ProductID="CVRFPID-277230">Cisco IOS 15.1(3)SVR1</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVR2">
            <FullProductName ProductID="CVRFPID-277253">Cisco IOS 15.1(3)SVR2</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVR3">
            <FullProductName ProductID="CVRFPID-279337">Cisco IOS 15.1(3)SVR3</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVR10">
            <FullProductName ProductID="CVRFPID-290618">Cisco IOS 15.1(3)SVR10</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVS">
          <Branch Type="Service Pack" Name="15.1(3)SVS">
            <FullProductName ProductID="CVRFPID-277232">Cisco IOS 15.1(3)SVS</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVS1">
            <FullProductName ProductID="CVRFPID-279335">Cisco IOS 15.1(3)SVS1</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVT">
          <Branch Type="Service Pack" Name="15.1(3)SVT1">
            <FullProductName ProductID="CVRFPID-280759">Cisco IOS 15.1(3)SVT1</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVT2">
            <FullProductName ProductID="CVRFPID-282026">Cisco IOS 15.1(3)SVT2</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVT3">
            <FullProductName ProductID="CVRFPID-284785">Cisco IOS 15.1(3)SVT3</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVT4">
            <FullProductName ProductID="CVRFPID-286399">Cisco IOS 15.1(3)SVT4</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVU">
          <Branch Type="Service Pack" Name="15.1(3)SVU1">
            <FullProductName ProductID="CVRFPID-283833">Cisco IOS 15.1(3)SVU1</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVU10">
            <FullProductName ProductID="CVRFPID-284291">Cisco IOS 15.1(3)SVU10</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVU2">
            <FullProductName ProductID="CVRFPID-284566">Cisco IOS 15.1(3)SVU2</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVU11">
            <FullProductName ProductID="CVRFPID-286400">Cisco IOS 15.1(3)SVU11</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVU20">
            <FullProductName ProductID="CVRFPID-289270">Cisco IOS 15.1(3)SVU20</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVU21">
            <FullProductName ProductID="CVRFPID-290557">Cisco IOS 15.1(3)SVU21</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVV">
          <Branch Type="Service Pack" Name="15.1(3)SVV1">
            <FullProductName ProductID="CVRFPID-284341">Cisco IOS 15.1(3)SVV1</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVV2">
            <FullProductName ProductID="CVRFPID-286029">Cisco IOS 15.1(3)SVV2</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVV3">
            <FullProductName ProductID="CVRFPID-286940">Cisco IOS 15.1(3)SVV3</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVV4">
            <FullProductName ProductID="CVRFPID-289371">Cisco IOS 15.1(3)SVV4</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVW">
          <Branch Type="Service Pack" Name="15.1(3)SVW">
            <FullProductName ProductID="CVRFPID-286451">Cisco IOS 15.1(3)SVW</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVW1">
            <FullProductName ProductID="CVRFPID-286844">Cisco IOS 15.1(3)SVW1</FullProductName>
          </Branch>
        </Branch>
        <Branch Type="Product Version" Name="15.1SVX">
          <Branch Type="Service Pack" Name="15.1(3)SVX">
            <FullProductName ProductID="CVRFPID-286927">Cisco IOS 15.1(3)SVX</FullProductName>
          </Branch>
          <Branch Type="Service Pack" Name="15.1(3)SVX1">
            <FullProductName ProductID="CVRFPID-289301">Cisco IOS 15.1(3)SVX1</FullProductName>
          </Branch>
        </Branch>
      </Branch>
      <Branch Type="Product Name" Name="Cisco IOS XE Software">
        <Branch Type="Product Version" Name="17.11SW">
          <Branch Type="Service Pack" Name="17.11.99SW">
            <FullProductName ProductID="CVRFPID-296860">Cisco IOS XE Software 17.11.99SW</FullProductName>
          </Branch>
        </Branch>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco IOS Software Internet Key Exchange Memory Leak Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCtx66011</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCtx66011</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2013-5473</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-105332</ProductID>
        <ProductID>CVRFPID-107861</ProductID>
        <ProductID>CVRFPID-108614</ProductID>
        <ProductID>CVRFPID-111552</ProductID>
        <ProductID>CVRFPID-111553</ProductID>
        <ProductID>CVRFPID-111558</ProductID>
        <ProductID>CVRFPID-114012</ProductID>
        <ProductID>CVRFPID-114167</ProductID>
        <ProductID>CVRFPID-115982</ProductID>
        <ProductID>CVRFPID-116254</ProductID>
        <ProductID>CVRFPID-116726</ProductID>
        <ProductID>CVRFPID-184123</ProductID>
        <ProductID>CVRFPID-190983</ProductID>
        <ProductID>CVRFPID-277230</ProductID>
        <ProductID>CVRFPID-277232</ProductID>
        <ProductID>CVRFPID-277253</ProductID>
        <ProductID>CVRFPID-279335</ProductID>
        <ProductID>CVRFPID-279337</ProductID>
        <ProductID>CVRFPID-280759</ProductID>
        <ProductID>CVRFPID-282026</ProductID>
        <ProductID>CVRFPID-283833</ProductID>
        <ProductID>CVRFPID-284291</ProductID>
        <ProductID>CVRFPID-284341</ProductID>
        <ProductID>CVRFPID-284566</ProductID>
        <ProductID>CVRFPID-284785</ProductID>
        <ProductID>CVRFPID-286029</ProductID>
        <ProductID>CVRFPID-286399</ProductID>
        <ProductID>CVRFPID-286400</ProductID>
        <ProductID>CVRFPID-286451</ProductID>
        <ProductID>CVRFPID-286844</ProductID>
        <ProductID>CVRFPID-286927</ProductID>
        <ProductID>CVRFPID-286940</ProductID>
        <ProductID>CVRFPID-289270</ProductID>
        <ProductID>CVRFPID-289301</ProductID>
        <ProductID>CVRFPID-289371</ProductID>
        <ProductID>CVRFPID-290557</ProductID>
        <ProductID>CVRFPID-290618</ProductID>
        <ProductID>CVRFPID-296860</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds for this vulnerability.



The following identification mechanism exists for this vulnerability.

Embedded Event Manager (EEM)
A Cisco IOS Embedded Event Manager (EEM) policy that is based on Tool Command Language (Tcl) can be used on vulnerable Cisco IOS devices to identify and detect a memory leak that is caused by this vulnerability. The policy allows administrators to monitor the memory for the affected process on a Cisco IOS device. When Cisco IOS EEM detects potential exploitation of this vulnerability, the policy can trigger a response by sending an alert to the network administrator, who could then decide to implement an upgrade or reload the device to recover the lost memory at a suitable time. The example policy is based on a Tcl script that sends a syslog message when the memory keeps dropping and reaches EEM_IKE_BUFF_INCR_THRES and when the IKE buffers have dropped EEM_IKE_BUFF_INCR_THRES times. If IKE buffers are freed the counter starts counting from zero. After generating the memory leak syslog message the script re-initializes. 

The Tcl script is available for download in Cisco Beyond: Embedded Event Manager (EEM) Scripting Community["https://supportforums.cisco.com/docs/DOC-30300"].



 A sample device configuration follows:






event manager environment EEM_MEM_LEAK_INTERVAL 20
event manager environment EEM_MEM_LEAK_MAX_RUNTIME 5
event manager environment EEM_IKE_BUFF_INCR_THRES 3
event manager environment EEM_FREE_MEMORY_THRES 70
event manager directory user policy "flash:/"
event manager policy eem_ike_mem_leak.tcl

</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130925-ike</URL>
        <Description>Cisco IOS Software Internet Key Exchange Memory Leak Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
