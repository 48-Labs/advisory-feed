<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20150325-mdns</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.4</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2015-03-25T15:42:47</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2015-03-25T21:26:59</cvrf:Date>
        <cvrf:Description>Updated the First Fixed Release for All Advisories in the March 2015 Cisco IOS Software Security Advisory Bundled Publication table.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.2</cvrf:Number>
        <cvrf:Date>2015-03-26T20:49:58</cvrf:Date>
        <cvrf:Description>Updated Workarounds Section</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.3</cvrf:Number>
        <cvrf:Date>2015-09-28T14:09:22</cvrf:Date>
        <cvrf:Description>Added Cisco IOS XE 3.6.0E as an affected release.  Added 3.6.2E as a first fixed for bundle wide for 3.6E since it became available after the bundle was published.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.4</cvrf:Number>
        <cvrf:Date>2016-01-14T17:04:07</cvrf:Date>
        <cvrf:Description>Updated Cisco IOS Checker Software Checker form to query all previously published Cisco IOS Software Security Advisories.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2015-03-25T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2016-01-14T17:22:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the multicast DNS (mDNS) gateway function of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to reload the vulnerable device.



The vulnerability is due to improper validation of mDNS packets. An attacker could exploit this vulnerability by sending malformed IP version 4 (IPv4) or IP version 6 (IPv6) packets on UDP port 5353. An exploit could allow the attacker to cause a denial of service (DoS) condition.



Cisco has released software updates that address this vulnerability. This advisory is available at the following link:

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150325-mdns["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150325-mdns"]wo



Note: The March 25, 2015, Cisco IOS &amp; XE Software Security Advisory bundled publication includes seven Cisco Security Advisories. The advisories address vulnerabilities in Cisco IOS Software and Cisco IOS XE Software. Individual publication links are in Cisco Event Response: Semiannual Cisco IOS &amp; XE Software Security Advisory Bundled Publication at the following link:
http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_mar15.html["http://www.cisco.com/web/about/security/intelligence/Cisco_ERP_mar15.html"]

</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2"></cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">Cisco devices that are running affected Cisco IOS Software or Cisco IOS XE Software are vulnerable. Cisco mDNS Gateway functionality is enabled by default on Cisco IOS Software and Cisco IOS XE Software. There is no specific configuration on the affected device needed to process mDNS packets.



To determine whether a Cisco IOS device or Cisco IOS XE device would process mDNS packets, log in to the device and issue either of the following command-line interface (CLI) commands: show ip socket, show udp, or show control-plane host open-ports. If the output shows any IP addresses listening on UDP port 5353, the device is vulnerable.



The following example shows a Cisco IOS device that is affected by this vulnerability. The device is vulnerable because the socket is open on UDP port 5353:

Router#show ip socket  
Proto Remote Port Local Port In Out Stat TTY OutputIF 
17 --listen-- 192.168.0.1 67 0 0 1 0 
17 --listen-- 192.168.0.1 68 0 0 1 0 
17 --listen-- 224.0.0.251 5353 0 0 1 0
Router#

Router#sho udp 
Proto        Remote      Port      Local       Port  In Out  Stat TTY OutputIF
17     224.0.0.251      5353 --any--          5353   0   0 1000021   0 
17(v6) FF02::FB         5353 --any--          5353   0   0 1020021   0 
Router#

Router#sho control-plane host open-ports 
Active internet connections (servers and established)
Prot               Local Address             Foreign Address                  Service    State
 tcp                        *:22                         *:0               SSH-Server   LISTEN
 tcp                        *:23                         *:0                   Telnet   LISTEN
 udp                      *:5353               224.0.0.251:0         IOS host service   LISTEN
Router#



Note: The behavior of Cisco IOS Software and Cisco IOS XE Software prior to the fix for Cisco bug ID CSCum51028 is to turn the mDNS functionality on by default. This behavior was changed in response to Cisco bug ID CSCum51028 and is now disabled by default. If the administrator wants to enable mDNS functionality, it must be manually configured on a device.



On Cisco IOS Software and Cisco IOS XE Software releases that have a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality must be explicitly enabled by configuring the service-routing mdns-sd CLI global configuration command. On those releases, if the command service-routing mdns-sd is in the configuration, the device may be vulnerable.



To determine the Cisco IOS Software release that is running on a Cisco product, administrators can log in to the device and issue the show version command to display the system banner. The system banner confirms that the device is running Cisco IOS Software by displaying text similar to "Cisco Internetwork Operating System Software" or "Cisco IOS Software. The image name displays in parentheses, followed by the Cisco IOS Software release number and release name. Other Cisco devices do not have the show version command or may provide different output.

The following example identifies a Cisco product that is running Cisco IOS Software Release 15.2(4)M5 with an installed image name of C3900-UNIVERSALK9-M:


Router&gt; show version 
Cisco IOS Software, C3900 Software (C3900-UNIVERSALK9-M), Version 15.2(4)M5, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2013 by Cisco Systems, Inc.
Compiled Fri 13-Sep-13 16:44 by prod_rel_team
!--- output truncated

Additional information about Cisco IOS Software release naming conventions is available in White Paper: Cisco IOS and NX-OS Software Reference Guide["http://www.cisco.com/web/about/security/intelligence/ios-ref.html"]. 
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">Cisco IOS XR Software is not affected by this vulnerability.



No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">The Cisco Service Discovery Gateway (mDNS Gateway) is a Cisco IOS component that allows for controlled and secure access to services and devices across subnets. It listens to service announcements on all configured network segments and builds a cache of services and addresses.



A vulnerability in the multicast DNS (mDNS) gateway function of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to reload the vulnerable device.



The vulnerability is due to improper validation of mDNS packets. An attacker could exploit this vulnerability by sending malformed IP version 4 (IPv4) or IP version 6 (IPv6) packets on UDP port 5353. An exploit could allow the attacker to cause a denial of service (DoS) condition.



This vulnerability can be exploited using either IPv4 or IPv6 packets. The vulnerability can be triggered by malformed packets destined for UDP port 5353 using the IPv4 or IPv6 unicast address of any interface configured on a device, the IPv4 multicast address 224.0.0.251, or the IPv6 multicast address FF02::FB.



This vulnerability can be triggered only by traffic destined to an affected device and cannot be exploited using traffic transiting an affected device.



In devices that meet the vulnerable configuration criteria, malformed UDP mDNS packets could trigger this vulnerability. An attacker with knowledge of the infrastructure could craft mDNS packets with set conditions to exploit this vulnerability. Successful exploitation of the vulnerability can result in a reload of the affected device.



This vulnerability is documented in Cisco bug ID CSCup70579["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCup70579"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2015-0650.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">Access Control Lists



On Cisco IOS Software and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.



On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.



Because the mDNS feature in this vulnerability uses UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.



The following ACL example should be included as part of the deployed interface access list, which will help protect the device from traffic destined to UDP port 5353:

!---
!--- Deny IPv4 mDNS traffic to a device
!--- 

access-list 150 deny udp any any eq 5353  

!--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in 
!--- accordance with existing security policies and 
!--- configurations. Permit all other traffic to transit the
!--- device.  

access-list 150 permit ip any any  

!---
!--- Deny IPv6 mDNS traffic to a device
!--- 

ipv6 access-list v6_list
  deny udp any any eq 5353  

!--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in 
!--- accordance with existing security policies and 
!--- configurations. Permit all other traffic to transit the
!--- device.  

permit ipv6 any any  

!--- Apply access list to all interfaces (only one example
!--- shown)  

interface fastEthernet 2/0 
ip access-group 150 in
  ipv6 traffic-filter v6_list in




Control Plane Policing



Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.



The following CoPP example should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353:

!---
!--- Match IPv4 mDNS traffic with permit statement
!--- 

access-list 150 permit udp any any eq 5353  

!--- Permit (police or drop)/Deny (allow) all other Layer 3 and 
!--- Layer 4 IPv4 traffic in accordance with existing security policies 
!--- and configurations for traffic that is authorized to be sent 
!--- to infrastructure devices 
!--- 

access-list 150 deny ip any any  

!--- Create a Class-Map for traffic to be policed by
!--- the CoPP feature
!---

class-map match-all drop-udp-class 
match access-group 150

!--- Create a policy map that will be applied to the 
!--- control plane of the device.  

policy-map drop-udp-traffic class drop-udp-class drop  

!--- Apply the policy map to the 
!--- control plane of the device  

control-plane service-policy 
input drop-udp-traffic



In the preceding CoPP example, the access control list entries (ACE) that match the potential exploit packets with the permit action cause these packets to be discarded by the policy map drop function, while packets that match the deny action (not shown) are not affected by the policy map drop function. Note that the policy map syntax is different in the 12.2S and 12.0S Cisco IOS software trains:

policy-map drop-udp-traffic 
  class drop-udp-class 
  police 32000 1500 1500 conform-action drop exceed-action drop



Additional information about the configuration and use of the CoPP feature is in Control Plane Policing Implementation Best Practices and Control Plane Policing.



On Cisco IOS Software and Cisco IOS XE Software releases that contain a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the no service-routing mdns-sd CLI global configuration command.



Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link:

https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=37485["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=37485"]</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">When considering software upgrades, customers are advised to consult the Cisco Security Advisories, Responses, and Alerts archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution.



In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and  confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 



&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;

    
        
    
    
        Cisco IOS Software
        Cisco provides a tool to help customers determine their exposure to vulnerabilities in Cisco IOS Software. The Cisco IOS Software Checker["https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x"] allows customers to perform the following tasks:

        
            Initiate a search by selecting releases from the drop-down menu or uploading a file from a local system 
            Enter show version command output for the tool to parse 
            Create a customized search by including all previously published Cisco Security Advisories, a specific publication, or all advisories in the most recent bundled publication 
        
        The tool identifies any Cisco Security Advisories that impact a queried software release and the earliest release that corrects all vulnerabilities in each Cisco Security Advisory ("First Fixed"). If applicable, the tool also returns the earliest possible release that corrects all vulnerabilities in all displayed advisories ("Combined First Fixed"). Please visit the Cisco IOS Software Checker["https://sec.cloudapps.cisco.com/security/center/selectIOSVersion.x"] or enter a Cisco IOS Software release in the following field to determine whether the release is affected by any published Cisco IOS Software advisory. 

        (Example entry: 15.1(4)M2)
        

        
            
            
            
            
            
            
            
            
            

            
            

        
    




For a mapping of Cisco IOS XE Software releases to Cisco IOS Software releases, refer to Cisco IOS XE 2 Release Notes["http://www.cisco.com/c/en/us/td/docs/ios/ios_xe/2/release/notes/rnasr21/rnasr21_gen.html#wp3000032"], Cisco IOS XE 3S Release Notes["http://www.cisco.com/c/en/us/td/docs/ios/ios_xe/3/release/notes/asr1k_rn_3s_rel_notes/asr1k_rn_3s_sys_req.html#wp3069754"], and Cisco IOS XE 3SG Release Notes["http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst4500/release/note/OL_24726.html#pgfId-2570252"].



Cisco IOS XE Software



Cisco IOS XE Software is affected by the vulnerabilities described in this advisory.






    
        
            Cisco IOS XE Software Release
            First Fixed Release for this Advisory
            First Fixed Release for All Advisories in the March 2015 Cisco IOS Software Security Advisory Bundled Publication
        
        
            2.5.x
            Not vulnerable

            
            Vulnerable; migrate to 3.12.3S or later.
        
        
            2.6.x
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.1.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.1.xSG
            Not vulnerable
            Not vulnerable
        
        
            3.2.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.2.xSE
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.2.xSG
            Not vulnerable
            Not vulnerable
        
        
            3.2.xXO
            Not vulnerable
            Not vulnerable
        
        
            3.2.xSQ
            Not vulnerable
            Not vulnerable
        
        
            3.3.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.3.xSE
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.3.xSG
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.3.xXO
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.3.xSQ
            Not vulnerable
            Not vulnerable
        
        
            3.4.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.4.xSG
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.4.xSQ
            Not vulnerable
            Not vulnerable
        
        
            3.5.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.5.xE
            Not vulnerable
            Vulnerable; migrate to 3.7.1E or later.
        
        
            3.6.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.6.xE
            3.6.1E
            3.6.2E
        
        
            3.7.xS
            Not vulnerable
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.7.xE
            Not vulnerable
            3.7.1E

            
        
        
            3.8.xS
            Not vulnerable

            
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.9.xS
            Vulnerable; migrate to 3.10.4S or later.
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.10.xS
            3.10.4S

            
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.11.xS
            3.11.3S

            
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.12.xS
            3.12.2S

            
            Vulnerable; migrate to 3.12.3S or later.
        
        
            3.13.xS
            3.13.1S

            
            3.13.2S

            
        
        
            3.14.xS

            
            Not vulnerable

            
            Not vulnerable
        
        
            3.15.xS

            
            Not vulnerable
            Not vulnerable
        
    
</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.



This vulnerability was found during the resolution of a support case.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference>
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=37485</cvrf:URL>
      <cvrf:Description>Identifying and Mitigating the Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150325-mdns</cvrf:URL>
      <cvrf:Description>Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
    <cvrf:Reference>
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/viewAlert.x?alertId=37820</cvrf:URL>
      <cvrf:Description>Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="IOS" Type="Product Name">
        <Branch Name="15.1SY" Type="Product Version">
          <Branch Name="15.1(2)SY" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-184932">Cisco IOS 15.1(2)SY</FullProductName>
          </Branch>
          <Branch Name="15.1(2)SY1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-188061">Cisco IOS 15.1(2)SY1</FullProductName>
          </Branch>
          <Branch Name="15.1(2)SY2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-189219">Cisco IOS 15.1(2)SY2</FullProductName>
          </Branch>
          <Branch Name="15.1(2)SY3" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198059">Cisco IOS 15.1(2)SY3</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.3S" Type="Product Version">
          <Branch Name="15.3(3)S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-117783">Cisco IOS 15.3(3)S</FullProductName>
          </Branch>
          <Branch Name="15.3(2)S2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-191331">Cisco IOS 15.3(2)S2</FullProductName>
          </Branch>
          <Branch Name="15.3(3)S1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-193406">Cisco IOS 15.3(3)S1</FullProductName>
          </Branch>
          <Branch Name="15.3(3)S2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-193407">Cisco IOS 15.3(3)S2</FullProductName>
          </Branch>
          <Branch Name="15.3(3)S3" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-193408">Cisco IOS 15.3(3)S3</FullProductName>
          </Branch>
          <Branch Name="15.3(3)S1a" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-197457">Cisco IOS 15.3(3)S1a</FullProductName>
          </Branch>
          <Branch Name="15.3(3)S2a" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198066">Cisco IOS 15.3(3)S2a</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.4T" Type="Product Version">
          <Branch Name="15.4(1)T" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115981">Cisco IOS 15.4(1)T</FullProductName>
          </Branch>
          <Branch Name="15.4(2)T" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-191997">Cisco IOS 15.4(2)T</FullProductName>
          </Branch>
          <Branch Name="15.4(1)T2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-196114">Cisco IOS 15.4(1)T2</FullProductName>
          </Branch>
          <Branch Name="15.4(1)T1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-196255">Cisco IOS 15.4(1)T1</FullProductName>
          </Branch>
          <Branch Name="15.4(2)T1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-201189">Cisco IOS 15.4(2)T1</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.2E" Type="Product Version">
          <Branch Name="15.2(1)E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-183811">Cisco IOS 15.2(1)E</FullProductName>
          </Branch>
          <Branch Name="15.2(2)E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-187057">Cisco IOS 15.2(2)E</FullProductName>
          </Branch>
          <Branch Name="15.2(1)E1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-195469">Cisco IOS 15.2(1)E1</FullProductName>
          </Branch>
          <Branch Name="15.2(1)E2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198060">Cisco IOS 15.2(1)E2</FullProductName>
          </Branch>
          <Branch Name="15.2(1)E3" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200488">Cisco IOS 15.2(1)E3</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.2JB" Type="Product Version">
          <Branch Name="15.2(2)JB1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-187085">Cisco IOS 15.2(2)JB1</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.4S" Type="Product Version">
          <Branch Name="15.4(1)S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-187147">Cisco IOS 15.4(1)S</FullProductName>
          </Branch>
          <Branch Name="15.4(3)S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-193544">Cisco IOS 15.4(3)S</FullProductName>
          </Branch>
          <Branch Name="15.4(1)S1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-197474">Cisco IOS 15.4(1)S1</FullProductName>
          </Branch>
          <Branch Name="15.4(1)S2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198067">Cisco IOS 15.4(1)S2</FullProductName>
          </Branch>
          <Branch Name="15.4(2)S1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200485">Cisco IOS 15.4(2)S1</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.4M" Type="Product Version">
          <Branch Name="15.4(3)M" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-193350">Cisco IOS 15.4(3)M</FullProductName>
          </Branch>
          <Branch Name="15.4(3)M1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-201713">Cisco IOS 15.4(3)M1</FullProductName>
          </Branch>
          <Branch Name="15.4(3)M2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-204104">Cisco IOS 15.4(3)M2</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.4SN" Type="Product Version">
          <Branch Name="15.4(2)SN" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198309">Cisco IOS 15.4(2)SN</FullProductName>
          </Branch>
          <Branch Name="15.4(2)SN1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198528">Cisco IOS 15.4(2)SN1</FullProductName>
          </Branch>
          <Branch Name="15.4(3)SN1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-204107">Cisco IOS 15.4(3)SN1</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.3JN" Type="Product Version">
          <Branch Name="15.3(3)JN" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200492">Cisco IOS 15.3(3)JN</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="12.4JAP" Type="Product Version">
          <Branch Name="12.4(25e)JAP1m" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-204819">Cisco IOS 12.4(25e)JAP1m</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.3JA" Type="Product Version">
          <Branch Name="15.3(3)JA1n" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-204310">Cisco IOS 15.3(3)JA1n</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="15.3JNB" Type="Product Version">
          <Branch Name="15.3(3)JNB" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-205723">Cisco IOS 15.3(3)JNB</FullProductName>
          </Branch>
        </Branch>
      </Branch>
      <Branch Name="Cisco IOS XE Software" Type="Product Name">
        <Branch Name="3.3SE" Type="Product Version">
          <Branch Name="3.3.0SE" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-196218">Cisco IOS XE Software 3.3.0SE</FullProductName>
          </Branch>
          <Branch Name="3.3.1SE" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-196925">Cisco IOS XE Software 3.3.1SE</FullProductName>
          </Branch>
          <Branch Name="3.3.2SE" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206200">Cisco IOS XE Software 3.3.2SE</FullProductName>
          </Branch>
          <Branch Name="3.3.3SE" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206201">Cisco IOS XE Software 3.3.3SE</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.3XO" Type="Product Version">
          <Branch Name="3.3.0XO" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-196220">Cisco IOS XE Software 3.3.0XO</FullProductName>
          </Branch>
          <Branch Name="3.3.1XO" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206163">Cisco IOS XE Software 3.3.1XO</FullProductName>
          </Branch>
          <Branch Name="3.3.2XO" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206164">Cisco IOS XE Software 3.3.2XO</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.5E" Type="Product Version">
          <Branch Name="3.5.0E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-197145">Cisco IOS XE Software 3.5.0E</FullProductName>
          </Branch>
          <Branch Name="3.5.1E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206168">Cisco IOS XE Software 3.5.1E</FullProductName>
          </Branch>
          <Branch Name="3.5.2E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206169">Cisco IOS XE Software 3.5.2E</FullProductName>
          </Branch>
          <Branch Name="3.5.3E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206170">Cisco IOS XE Software 3.5.3E</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.10S" Type="Product Version">
          <Branch Name="3.10.0S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198123">Cisco IOS XE Software 3.10.0S</FullProductName>
          </Branch>
          <Branch Name="3.10.1S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198124">Cisco IOS XE Software 3.10.1S</FullProductName>
          </Branch>
          <Branch Name="3.10.2S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-198125">Cisco IOS XE Software 3.10.2S</FullProductName>
          </Branch>
          <Branch Name="3.10.3S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-202539">Cisco IOS XE Software 3.10.3S</FullProductName>
          </Branch>
          <Branch Name="3.10.1xcS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213469">Cisco IOS XE Software 3.10.1xcS</FullProductName>
          </Branch>
          <Branch Name="3.10.2aS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213470">Cisco IOS XE Software 3.10.2aS</FullProductName>
          </Branch>
          <Branch Name="3.10.2tS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213471">Cisco IOS XE Software 3.10.2tS</FullProductName>
          </Branch>
          <Branch Name="3.10.1xbS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213642">Cisco IOS XE Software 3.10.1xbS</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.11S" Type="Product Version">
          <Branch Name="3.11.1S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200768">Cisco IOS XE Software 3.11.1S</FullProductName>
          </Branch>
          <Branch Name="3.11.2S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200771">Cisco IOS XE Software 3.11.2S</FullProductName>
          </Branch>
          <Branch Name="3.11.0S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-203353">Cisco IOS XE Software 3.11.0S</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.12S" Type="Product Version">
          <Branch Name="3.12.0S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-200770">Cisco IOS XE Software 3.12.0S</FullProductName>
          </Branch>
          <Branch Name="3.12.1S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206161">Cisco IOS XE Software 3.12.1S</FullProductName>
          </Branch>
          <Branch Name="3.12.0aS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213473">Cisco IOS XE Software 3.12.0aS</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.13S" Type="Product Version">
          <Branch Name="3.13.0S" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-201495">Cisco IOS XE Software 3.13.0S</FullProductName>
          </Branch>
          <Branch Name="3.13.0aS" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-213781">Cisco IOS XE Software 3.13.0aS</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="3.6E" Type="Product Version">
          <Branch Name="3.6.0E" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-206172">Cisco IOS XE Software 3.6.0E</FullProductName>
          </Branch>
          <Branch Name="3.6.0aE" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-210073">Cisco IOS XE Software 3.6.0aE</FullProductName>
          </Branch>
        </Branch>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCup70579</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCup70579</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2015-0650</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-115981</ProductID>
        <ProductID>CVRFPID-117783</ProductID>
        <ProductID>CVRFPID-183811</ProductID>
        <ProductID>CVRFPID-184932</ProductID>
        <ProductID>CVRFPID-187057</ProductID>
        <ProductID>CVRFPID-187085</ProductID>
        <ProductID>CVRFPID-187147</ProductID>
        <ProductID>CVRFPID-188061</ProductID>
        <ProductID>CVRFPID-189219</ProductID>
        <ProductID>CVRFPID-191331</ProductID>
        <ProductID>CVRFPID-191997</ProductID>
        <ProductID>CVRFPID-193350</ProductID>
        <ProductID>CVRFPID-193406</ProductID>
        <ProductID>CVRFPID-193407</ProductID>
        <ProductID>CVRFPID-193408</ProductID>
        <ProductID>CVRFPID-193544</ProductID>
        <ProductID>CVRFPID-195469</ProductID>
        <ProductID>CVRFPID-196114</ProductID>
        <ProductID>CVRFPID-196255</ProductID>
        <ProductID>CVRFPID-197457</ProductID>
        <ProductID>CVRFPID-197474</ProductID>
        <ProductID>CVRFPID-198059</ProductID>
        <ProductID>CVRFPID-198060</ProductID>
        <ProductID>CVRFPID-198066</ProductID>
        <ProductID>CVRFPID-198067</ProductID>
        <ProductID>CVRFPID-198309</ProductID>
        <ProductID>CVRFPID-198528</ProductID>
        <ProductID>CVRFPID-200485</ProductID>
        <ProductID>CVRFPID-200488</ProductID>
        <ProductID>CVRFPID-200492</ProductID>
        <ProductID>CVRFPID-201189</ProductID>
        <ProductID>CVRFPID-201713</ProductID>
        <ProductID>CVRFPID-204104</ProductID>
        <ProductID>CVRFPID-204107</ProductID>
        <ProductID>CVRFPID-204310</ProductID>
        <ProductID>CVRFPID-204819</ProductID>
        <ProductID>CVRFPID-205723</ProductID>
        <ProductID>CVRFPID-196218</ProductID>
        <ProductID>CVRFPID-196220</ProductID>
        <ProductID>CVRFPID-196925</ProductID>
        <ProductID>CVRFPID-197145</ProductID>
        <ProductID>CVRFPID-198123</ProductID>
        <ProductID>CVRFPID-198124</ProductID>
        <ProductID>CVRFPID-198125</ProductID>
        <ProductID>CVRFPID-200768</ProductID>
        <ProductID>CVRFPID-200770</ProductID>
        <ProductID>CVRFPID-200771</ProductID>
        <ProductID>CVRFPID-201495</ProductID>
        <ProductID>CVRFPID-202539</ProductID>
        <ProductID>CVRFPID-203353</ProductID>
        <ProductID>CVRFPID-206161</ProductID>
        <ProductID>CVRFPID-206163</ProductID>
        <ProductID>CVRFPID-206164</ProductID>
        <ProductID>CVRFPID-206168</ProductID>
        <ProductID>CVRFPID-206169</ProductID>
        <ProductID>CVRFPID-206170</ProductID>
        <ProductID>CVRFPID-206172</ProductID>
        <ProductID>CVRFPID-206200</ProductID>
        <ProductID>CVRFPID-206201</ProductID>
        <ProductID>CVRFPID-210073</ProductID>
        <ProductID>CVRFPID-213469</ProductID>
        <ProductID>CVRFPID-213470</ProductID>
        <ProductID>CVRFPID-213471</ProductID>
        <ProductID>CVRFPID-213473</ProductID>
        <ProductID>CVRFPID-213642</ProductID>
        <ProductID>CVRFPID-213781</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>Access Control Lists



On Cisco IOS Software and Cisco IOS XE Software releases that do not have a fix for Cisco bug ID CSCum51028, there is currently no way to manually close the port or disable the service.



On those releases, a possible workaround consists of configuring an extended access control list (ACL) that can be created and applied to an interface to block traffic destined to UDP port 5353.



Because the mDNS feature in this vulnerability uses UDP as a transport, it is possible to spoof the sender's IP address, which may defeat ACLs that permit communication to these ports from trusted IP addresses. In addition to ACLs, administrators should enable uRPF, a security feature of Cisco IOS Software that verifies the reachability of the source address in packets being forwarded. The combination of these two technologies offers a stronger workaround than ACLs alone.



The following ACL example should be included as part of the deployed interface access list, which will help protect the device from traffic destined to UDP port 5353:

!---
!--- Deny IPv4 mDNS traffic to a device
!--- 

access-list 150 deny udp any any eq 5353  

!--- Permit/deny all other Layer 3 and Layer 4 IPv4 traffic in 
!--- accordance with existing security policies and 
!--- configurations. Permit all other traffic to transit the
!--- device.  

access-list 150 permit ip any any  

!---
!--- Deny IPv6 mDNS traffic to a device
!--- 

ipv6 access-list v6_list
  deny udp any any eq 5353  

!--- Permit/deny all other Layer 3 and Layer 4 IPv6 traffic in 
!--- accordance with existing security policies and 
!--- configurations. Permit all other traffic to transit the
!--- device.  

permit ipv6 any any  

!--- Apply access list to all interfaces (only one example
!--- shown)  

interface fastEthernet 2/0 
ip access-group 150 in
  ipv6 traffic-filter v6_list in




Control Plane Policing



Control Plane Policing (CoPP) can be used to block untrusted UDP traffic to the device. Cisco IOS Software releases 12.0S, 12.2SX, 12.2S, 12.3T, 12.4, and 12.4T support the CoPP feature. CoPP can be configured on a device to help protect the management and control planes and minimize the risk and effectiveness of direct infrastructure attacks by explicitly permitting only authorized traffic that is sent to infrastructure devices in accordance with existing security policies and configurations.



The following CoPP example should be included as part of the deployed CoPP, which will help protect the device from traffic destined to UDP port 5353:

!---
!--- Match IPv4 mDNS traffic with permit statement
!--- 

access-list 150 permit udp any any eq 5353  

!--- Permit (police or drop)/Deny (allow) all other Layer 3 and 
!--- Layer 4 IPv4 traffic in accordance with existing security policies 
!--- and configurations for traffic that is authorized to be sent 
!--- to infrastructure devices 
!--- 

access-list 150 deny ip any any  

!--- Create a Class-Map for traffic to be policed by
!--- the CoPP feature
!---

class-map match-all drop-udp-class 
match access-group 150

!--- Create a policy map that will be applied to the 
!--- control plane of the device.  

policy-map drop-udp-traffic class drop-udp-class drop  

!--- Apply the policy map to the 
!--- control plane of the device  

control-plane service-policy 
input drop-udp-traffic



In the preceding CoPP example, the access control list entries (ACE) that match the potential exploit packets with the permit action cause these packets to be discarded by the policy map drop function, while packets that match the deny action (not shown) are not affected by the policy map drop function. Note that the policy map syntax is different in the 12.2S and 12.0S Cisco IOS software trains:

policy-map drop-udp-traffic 
  class drop-udp-class 
  police 32000 1500 1500 conform-action drop exceed-action drop



Additional information about the configuration and use of the CoPP feature is in Control Plane Policing Implementation Best Practices and Control Plane Policing.



On Cisco IOS Software and Cisco IOS XE Software releases that contain a fix for Cisco bug ID CSCum51028, mDNS Gateway functionality can be disabled by configuring the no service-routing mdns-sd CLI global configuration command.



Additional mitigations that can be deployed on Cisco devices within the network are available in the Cisco Applied Mitigation Bulletin companion document for this advisory, which is available at the following link:

https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=37485["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=37485"]</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150325-mdns</URL>
        <Description>Cisco IOS Software and IOS XE Software mDNS Gateway Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
