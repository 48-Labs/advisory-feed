<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco ASA 1000V Cloud Firewall H.323 Inspection Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20130116-asa1000v</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2013-01-16T15:24:36</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2013-01-16T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2013-01-16T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in Cisco Adaptive Security Appliance (ASA) Software for the Cisco ASA 1000V Cloud Firewall may cause the Cisco ASA 1000V to reload after processing a malformed H.323 message. Cisco ASA 1000V Cloud Firewall is affected when H.323 inspection is enabled.



Cisco has released software updates that address this vulnerability.



This advisory is posted at the following link:



https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130116-asa1000v["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130116-asa1000v"]



Note:  Only Cisco ASA Software for the Cisco ASA 1000V Cloud Firewall is affected by the vulnerability described in this advisory. Cisco ASA 5500 Series Adaptive Security Appliances, Cisco Catalyst 6500 Series ASA Services Module or Cisco Catalyst 6500 Series Firewall Services Module (FWSM) are not affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2"></cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">Versions 8.7.1 and 8.7.1.1 of Cisco ASA Software for the Cisco ASA 1000V Cloud Firewall are affected by this vulnerability if H.323 inspection is enabled. H.323 Inspection for both H.225 and Registration, Admission and Status (RAS) messages is enabled by default.



The vulnerability exists only if H.323 inspection for H.225 messages is enabled. H.323 inspection for RAS messages has no effect on this vulnerability.



To determine whether H.323 H.225 inspection is enabled, issue the show service-policy inspect h323 h225 command and verify that a class map is configured with the H.225 inspection engine. If H.323 inspection for H.225 messages is configured, the relevant H.323 output will appear under the referenced class map.



Example output follows:

ASA1000v# show service-policy inspect h323 h225 
Global policy: 
  Service-policy: global_policy
    Class-map: inspection_default
      Inspect: h323 h225 _default_h323_map, packet 0, lock fail 0, drop 0, reset-drop 0
               tcp-proxy: bytes in buffer 0, bytes dropped 0
        h245-tunnel-block drops 0 connection



Note: The preceding output identifies a policy map with a class map that has H.323 inspection for H.225 messages applied.




Alternatively, a device that has H.323 inspection for H.225 messages enabled has a configuration similar to the following:




class-map inspection_default 
 match default-inspection-traffic
!
policy-map global_policy
 class inspection_default
  ...
  inspect h323 h225
  ...
!
service-policy global_policy global


Note: Global application is shown in the preceding example, but the service policy could also be applied to a specific interface



Customers who use Cisco Adaptive Security Device Manager (ASDM) to manage devices can check the Service Policy section under the global or interface specific policies to determine whether the inspection is enabled.



Customers who use Cisco Virtual Network Management Center (VNMC) to manage multiple devices can locate the Packet Inspection section under Policy Management &gt; Security Policies &gt; Root &gt; Tenant &gt; Data Center &gt; Policies to determine whether the inspection is enabled.



To determine the version of Cisco ASA Software for the Cisco ASA 1000V Cloud Firewall that is running, issue the show version command from the Cisco ASA 1000V command line.





The following example shows a system that is running an affected software version (8.7.1):





ASA1000v(config)# show version
Cisco Adaptive Security Appliance Software Version 8.7(1)
Device Manager Version 6.3(5)


Customers who use the Cisco Adaptive Security Device Manager (ASDM) to manage their devices can find the version of the software displayed in the table in the login window or in the upper left corner of the ASDM window. 





Alternatively, version information can be obtained from the Summary tab of the Cisco ASA 1000V Cloud Firewall resource in the VMware vCenter Server.</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">With the exception of Cisco ASA 1000V Cloud Firewall, no other Cisco products are currently known to be affected by this vulnerability.
</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">The Cisco ASA 1000V Cloud Firewall is a virtual security appliance that secures the tenant edge in multitenant private and public cloud deployments. It runs on VMware vSphere Hypervisor software and the Cisco Nexus 1000V Series Switch exclusively. 



The Cisco ASA 1000V Cloud Firewall allows virtual machines (VMs) in a virtual data center to access the Internet securely, functions as the default gateway for the VMs, and protects against network-based attacks.



Cisco ASA Software for the 1000V Cloud Firewall versions 8.7.1 and 8.7.1.1 contain a vulnerability that could allow an unauthenticated, remote attacker to cause a reload of the Cisco 1000V Cloud Firewall.



The vulnerability is due to incorrect handling of malformed H.323 packets. An attacker could exploit this vulnerability by sending a crafted H.323 packet through the affected device. An exploit could allow the attacker to reload the Cisco ASA 1000V Cloud Firewall, resulting in denial of service (DoS) condition.



A Cisco ASA 1000V device that is configured to inspect H.323 through-the-box traffic may reload when a malformed H.323 IPv4 packet is received. 



The H.323 control channel handles H.225, H.245 and H.323 RAS messages. H.323 inspection uses the following well-known ports:



1718���Gatekeeper Discovery UDP port

1719���RAS UDP port

1720���TCP control port


Additional dynamic UDP and TCP ports may be negotiated during the H.323 call signaling setup procedure.



A malformed packet sent to any of the well-known ports used by H.323 inspection, or to ports dynamically negotiated by H.323 call signaling setup, may trigger this vulnerability.



Only through-the-box traffic may trigger this vulnerability. Cisco ASA 1000V Cloud Firewall is affected only if H.323 inspection for H.225 messages is enabled.



Cisco ASA 1000V Cloud Firewall does not support H.323 inspection over IPv6 transport.



This vulnerability is documented in Cisco Bug ID CSCuc42812["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuc42812"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and CSCuc88741["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuc88741"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned CVE-2012-5419.
</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">If H.323 inspection is not required, it can be disabled so the device is no longer affected by the vulnerability. Administrators can disable H.323 inspection for H.225 messages by issuing the no inspect h323 h225 command in class configuration submode in the policy map configuration. H.323 inspection for H.225 messages should be disabled for the workaround to be effective. 



The following example shows how to disable H.323 inspection from the default policy-map:





ASA1000v(config)# policy-map global_policy
ASA1000v(config-pmap)# class inspection_default
ASA1000v(config-pmap-c)# no inspect h323 h225


If H.323 inspection for H.225 messages is required, there are no workarounds.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution.



In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 



This vulnerability has been fixed in Cisco ASA Software for the Cisco ASA 1000V Cloud Firewall version 8.7.1.3 and later.



Cisco ASA Software for the Cisco ASA 1000V Cloud Firewall can be downloaded at the following link:



http://software.cisco.com/download/type.html?mdfid=284145419&amp;catid=null["http://software.cisco.com/download/type.html?mdfid=284145419&amp;catid=null"]

</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 

This vulnerability was found during internal testing.
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130116-asa1000v</cvrf:URL>
      <cvrf:Description>Cisco ASA 1000V Cloud Firewall H.323 Inspection Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco ASA 1000V Cloud Firewall Software" Type="Product Name">
        <FullProductName ProductID="CVRFPID-185561">Cisco ASA 1000V Cloud Firewall Software </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco ASA 1000V Cloud Firewall H.323 Inspection Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCuc42812</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCuc42812,CSCuc88741</Note>
    </Notes>
    <CVE>CVE-2012-5419</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-185561</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>If H.323 inspection is not required, it can be disabled so the device is no longer affected by the vulnerability. Administrators can disable H.323 inspection for H.225 messages by issuing the no inspect h323 h225 command in class configuration submode in the policy map configuration. H.323 inspection for H.225 messages should be disabled for the workaround to be effective. 



The following example shows how to disable H.323 inspection from the default policy-map:





ASA1000v(config)# policy-map global_policy
ASA1000v(config-pmap)# class inspection_default
ASA1000v(config-pmap-c)# no inspect h323 h225


If H.323 inspection for H.225 messages is required, there are no workarounds.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130116-asa1000v</URL>
        <Description>Cisco ASA 1000V Cloud Firewall H.323 Inspection Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
