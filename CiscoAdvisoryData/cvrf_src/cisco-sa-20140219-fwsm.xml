<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Firewall Services Module Cut-Through Proxy Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20140219-fwsm</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2014-02-19T15:53:16</cvrf:Date>
        <cvrf:Description>Initial public release</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2014-02-19T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2014-02-19T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">Cisco Firewall Services Module (FWSM) Software contains a vulnerability that could allow an unauthenticated, remote attacker to cause a reload of an affected system.



The vulnerability is due to a race condition when releasing the memory allocated by the cut-through proxy function. An attacker could exploit this vulnerability by sending traffic to match the condition that triggers cut-through proxy authentication.



Cisco has released software updates that address this vulnerability. Workarounds that mitigate the vulnerability are not available. This advisory is available at the following link: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-fwsm["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-fwsm"]</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">Cisco FWSM Software for Cisco Catalyst 6500 Series Switches and Cisco
7600 Series Routers is affected by this vulnerability. Consult the "Software Versions and Fixes" section of this
security advisory for more information about the affected releases.



Cisco FWSM Software has reached the end of software maintenance releases
milestone. Cisco FWSM customers are encouraged to contact their Cisco
representative for available replacement.</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">Cisco FWSM is affected by this vulnerability if the cut-through proxy function is enabled. This function can be enabled for authentication, authorization and accounting via the match command or include commands. To determine whether this feature is in use, use the show running-config aaa authentication| include match|include command and verify that it returns output. Configurations that use an external AAA server or the Cisco FWSM local user database for AAA are vulnerable.



The following example shows a Cisco FWSM configured to authenticate traffic matching the access list SERVER_AUTH through the external AAA server called AuthOutbound. The configuration in the example is implemented with the match command.




FWSM/admin# show running-config aaa authentication| include match|include 
aaa authentication match SERVER_AUTH inside AuthOutbound



The following example shows an equivalent configuration implemented with the include command.






FWSM/admin# show running-config aaa authentication| include match|include 
aaa authentication include SERVER_AUTH inside AuthOutbound



The cut-through proxy function is not enabled by default on Cisco FWSM Software.



Determine the Running Software Version
To determine the version of the Cisco FWSM software that is running on a device, administrators can issue the show version command, as shown in the following example:

FWSM&gt; show version

FWSM Firewall Version 4.0(16)
[...]



Customers who use the Cisco Adaptive Security Device Manager (ASDM) to
manage their devices can find the version of the software displayed in
the table in the login window or in the upper left corner of the Cisco
ASDM window. The version notation is similar to the following example:

FWSM Version: 4.0(16)



Version information can also be obtained from the Cisco Catalyst 6500
Series Switch or the Cisco 7600 Series Router.  To determine the version
of Cisco FWSM Software that is running on a device, issue the show module
command from Cisco IOS Software or Cisco Catalyst Operating System
Software to identify which modules and submodules are installed on the
system.



The following example shows a system with a Cisco FWSM (WS-SVC-FWM-1) installed in slot 2:

switch&gt;show module
Mod Ports Card Type                              Model              Serial No.
--- ----- -------------------------------------- ------------------ -----------
  1   16  SFM-capable 16 port 1000mb GBIC        WS-X6516-GBIC      SAL06334NS9
  2    6  Firewall Module                        WS-SVC-FWM-1       SAD10360485
  3    8  Intrusion Detection System             WS-SVC-IDSM-2      SAD0932089Z
  4    4  SLB Application Processor Complex      WS-X6066-SLB-APC   SAD093004BD
  5    2  Supervisor Engine 720 (Active)         WS-SUP720-3B       SAL0934888E

Mod MAC addresses                       Hw    Fw           Sw           Status
--- ---------------------------------- ------ ------------ ------------ -------
  1  0009.11e3.ade8 to 0009.11e3.adf7   5.1   6.3(1)       8.7(0.22)BUB Ok
  2  0018.ba41.5092 to 0018.ba41.5099   4.0   7.2(1)       4.0(16)      Ok
  3  0014.a90c.9956 to 0014.a90c.995d   5.0   7.2(1)       7.0(4)E4     Ok
  4  0014.a90c.66e6 to 0014.a90c.66ed   1.7   Unknown      Unknown      PwrDown
  5  0013.c42e.7fe0 to 0013.c42e.7fe3   4.4   8.1(3)       12.2(33)SXH8 Ok

[...]



After locating the correct slot, issue the show module &lt;slot number&gt; command to identify the software version that is running, as shown in the following example:

switch&gt;show module 2
Mod Ports Card Type                              Model              Serial No.
--- ----- -------------------------------------- ------------------ -----------
  2    6  Firewall Module                        WS-SVC-FWM-1       SAD10360485

Mod MAC addresses                       Hw    Fw           Sw           Status
--- ---------------------------------- ------ ------------ ------------ -------
  2  0018.ba41.5092 to 0018.ba41.5099   4.0   7.2(1)       4.0(16)      Ok

[...]



The preceding example shows that the Cisco FWSM is running software version 4.0(16) as indicated by the Sw column.



If a Virtual Switching System (VSS) is used to allow two physical Cisco
Catalyst 6500 Series Switches to operate as a single logical virtual
switch, the show module switch all command can display
the software version of all FWSMs that belong to switch 1 and switch 2.
The output from this command will be similar to the output from show module  but will include module information for the modules in each switch in the VSS.</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">Cisco ASA Software is not affected by this vulnerability.



No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">The Cisco FWSM is a high-speed, integrated firewall module for Cisco
Catalyst 6500 Series Switches and Cisco 7600 Series Routers. The FWSM
offers firewall services with stateful packet filtering and deep packet
inspection.



Cisco FWSM Software supports the cut-through proxy feature for AAA network access services. 



A vulnerability in the cut-through proxy function of  Cisco Firewall Services Module (FWSM)
Software could allow an unauthenticated, remote attacker to cause a
reload of the affected system.




The vulnerability is due to a race
condition when releasing the memory allocated by the cut-through proxy function. An attacker could exploit this vulnerability by sending
traffic to match the condition that triggers cut-through proxy authentication. An exploit could allow the attacker to
trigger a reload of the affected system. Repeated exploitation could result in a denial of service (DoS) condition.



Note: This vulnerability affects both routed and transparent
firewall mode in both single and multiple context mode. This
vulnerability can be triggered by IP version 4 (IPv4) traffic only. Transit traffic and traffic directed to the FWSM device can be used to trigger this vulnerability. Configurations that use an external AAA server or the Cisco
FWSM local user database for AAA vulnerable.



This vulnerability is documented in Cisco bug ID CSCuj16824["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuj16824"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned
Common Vulnerabilities and Exposures (CVE) ID CVE-2014-0710.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">There are no workarounds that mitigate this vulnerability other than disabling the cut-through proxy feature.
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">When considering software upgrades, customers are advised to consult the Cisco Security Advisories, Responses, and Notices archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution. 

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and  confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 

The following table gives information on the release that fixes this vulnerability for each of the major release versions.




    
        
             
             3.1 

            
            
            3.2 

            
            
            4.0 

            
            
            4.1 

            
            
        
        
            CSCuj16824 - Cisco FWSM Cut-Through Proxy Denial of Service Vulnerability1

            
            Migrate to 3.2.x or later

            
             3.2(28) 

            
            Migrate to 4.1 or later 

            
             4.1(15) 

            
        
    



1 This vulnerability does not affect Cisco FWSM Software releases prior to 3.1(21), 3.2(21), 4.0(16), and 4.1(6).



Note:
Cisco FWSM Software has reached the end of software maintenance releases
milestone. Cisco FWSM customers are encouraged to contact their Cisco
representative for an available replacement.</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 

This vulnerability was found during the resolution of support cases.
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-fwsm</cvrf:URL>
      <cvrf:Description>Cisco Firewall Services Module Cut-Through Proxy Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Firewall Services Module (FWSM)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-5176">Cisco Firewall Services Module (FWSM) </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco FWSM Cut-Through Proxy Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCuj16824</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCuj16824</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2014-0710</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-5176</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.1</BaseScoreV2>
        <TemporalScoreV2>5.9</TemporalScoreV2>
        <VectorV2>AV:N/AC:M/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds that mitigate this vulnerability other than disabling the cut-through proxy feature.
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140219-fwsm</URL>
        <Description>Cisco Firewall Services Module Cut-Through Proxy Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
