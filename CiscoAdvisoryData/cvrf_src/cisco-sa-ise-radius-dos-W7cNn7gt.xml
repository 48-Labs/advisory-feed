<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Identity Services Engine RADIUS Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-ise-radius-dos-W7cNn7gt</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2023-09-06T15:51:52</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2023-09-06T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2023-09-06T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
      <cvrf:Date>2023-09-06T15:52:13.065677Z</cvrf:Date>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the RADIUS message processing feature of Cisco Identity Services Engine (ISE) could allow an unauthenticated, remote attacker to cause the affected system to stop processing RADIUS packets.

This vulnerability is due to improper handling of certain RADIUS accounting requests. An attacker could exploit this vulnerability by sending a crafted authentication request to a network access device (NAD) that uses Cisco ISE for authentication, authorization, and accounting (AAA). This would eventually result in the NAD sending a RADIUS accounting request packet to Cisco ISE. An attacker could also exploit this vulnerability by sending a crafted RADIUS accounting request packet to Cisco ISE directly if the RADIUS shared secret is known. A successful exploit could allow the attacker to cause the RADIUS process to unexpectedly restart, resulting in authentication or authorization timeouts and denying legitimate users access to the network or service. Clients already authenticated to the network would not be affected.

Note: To recover the ability to process RADIUS packets, a manual restart of the affected Policy Service Node (PSN) may be required. For more information, see the Details ["#details"] section of this advisory.

Cisco has released software updates that address this vulnerability. There are no workarounds that address this vulnerability.

This advisory is available at the following link: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-radius-dos-W7cNn7gt ["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-radius-dos-W7cNn7gt"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">This vulnerability affects Cisco ISE PSNs that are configured with RADIUS. If Cisco ISE is being used for TACACS only, the device is not affected.

Note: RADIUS is enabled by default and cannot be disabled. The default RADIUS policies may need to be configured to deny access to all users and devices if Cisco ISE is being used for TACACS only.

Note: For the exploit to be successful, attackers must have one of the following:

Valid user credentials
A NAD shared secret that can be used to connect to Cisco ISE
Access to a NAD that connects to a Cisco ISE deployment and that is configured with MAC Authentication Bypass (MAB) so that the authentication policy succeeds even if a user is not found

Determine PSN Configuration

To determine whether a node in the Cisco ISE deployment is a PSN, use the following steps:

Log in to the Cisco ISE web-based management interface.
Click the menu icon.
Choose Administration &gt; System &gt; Deployment.
Look at the Personas column in the table for the nodes in the deployment. If a node has Policy Service listed, the node is affected by this vulnerability. If Policy Service is not listed, the node is not affected by this vulnerability.

Determine the RADIUS Policy

If a deployment is being used for TACACS only and the RADIUS policy is set to DenyAccess, the deployment is not affected by this vulnerability.

To determine whether a deployment has a DenyAccess RADIUS policy in effect, use the following steps:

Log in to the Cisco ISE web-based management interface.
Click the menu icon.
Choose Policy &gt; Policy Sets. If RADIUS has never been deployed, only the Default policy should be listed. If more than one policy is listed, this deployment might be serving as a RADIUS server.
Click the arrow to check the Default policy.
In the Authentication Policy section, verify the following:
All rules are disabled except the Default rule.
Under Default &gt; Options, all options are REJECT or DROP.

In the Authorization Policy - Local Exceptions section, verify that all rules are disabled.
In the Authorization Policy - Global Exceptions section, verify that all rules are disabled.
In the Authorization Policy section, verify the following:
All rules are disabled except the Default rule.
The Default rule's profile is DenyAccess.</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">Only products listed in the Vulnerable Products ["#vp"] section of this advisory are known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="4">The affected Cisco ISE PSN should restart automatically. If the restart fails, a manual restart should be performed. The recommendations for a manual restart are as follows:

In a one-node deployment, the PSN persona will be located on the single node. That node will need to be restarted.
In a multi-node deployment, only the affected PSN node will need to be restarted.

For more information on Cisco ISE personas, see the Cisco ISE Admin Guide ["https://www.cisco.com/c/en/us/td/docs/security/ise/3-3/admin_guide/b_ise_admin_3_3/b_ISE_admin_33_deployment.html#typesofpersonas"].

Note:

If PSNs are behind a load balancer, the exploit traffic can cascade across to other PSNs.
If PSN node groups are configured, the exploit traffic will not cascade across to other PSNs.

Restart Cisco ISE

To stop and then start a Cisco ISE node from the CLI, use the following steps. For more details on each command, see the Cisco ISE CLI Reference Guide ["https://www.cisco.com/c/en/us/td/docs/security/ise/3-3/cli_guide/b_ise_CLI_Reference_Guide_33/b_ise_CLIReferenceGuide_33_chapter_01.html"].

Note: During the restart period, any devices already authenticated will still be connected to the network. New authentications will not be processed unless PSN failover is configured.

Log in to the affected PSN through the CLI.
Issue the command application stop ise and wait for the prompt to return output, as shown in the following example:

ise/admin# application stop ise
Stopping ISE Monitoring &amp; Troubleshooting Log Processor...  PassiveID WMI Service is disabled  PassiveID Syslog Service is disabled  PassiveID API Service is disabled
.
.
.

ise/admin#

Issue the command application start ise and wait for the prompt to return output, as shown in the following example:

ise/admin# application start ise
Verified OK

ISE Database processes already running, PID: 3310843
Stopping ISE Database processes...
Starting ISE Messaging Service...
Starting ISE API Gateway Database Service....
.
.
ise/admin#


Issue the command show application status ise to see the status of the processes, as shown in the following example.
Note: When the Application Server is running, authentications will take place and the node will be accessible through the GUI.

ise/admin# show application status ise
ISE PROCESS NAME     STATE        PROCESS ID  --------------------------------------------------------------------  Database Listener            running       3313832  Database Server              running       92 PROCESSES  Application Server          running      3330909  Profiler Database             running       3321522  ISE Indexing Engine         running       3332725  .
.
.
ise/admin#


PSN Failover Information

For PSN failover options, see the Policy Service Nodes and Node Groups section of this Cisco Press article ["https://www.ciscopress.com/articles/article.asp?p=2812072&amp;seqNum=2"].

For information on how to configure node groups, see the Policy Service Node section ["https://www.cisco.com/c/en/us/td/docs/security/ise/3-3/admin_guide/b_ise_admin_3_3/b_ISE_admin_33_deployment.html#ID64"] of the Cisco ISE Admin Guide.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">There are no workarounds that address this vulnerability. However, several potential mitigations may help address this vulnerability.

To mitigate this vulnerability, customers can turn off RADIUS accounting on the network access device (NAD) sending the crafted packets to the Cisco ISE PSN. There may be other mitigations for this vulnerability for customers who cannot upgrade to a fixed release. To coordinate implementation of the mitigations, contact the Cisco Technical Assistance Center (TAC) ["https://www.cisco.com/go/tac/"].

While these mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">Cisco has released free software updates ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#ssu"] that address the vulnerability described in this advisory. Customers with service contracts that entitle them to regular software updates should obtain security fixes through their usual update channels.

Customers may only install and expect support for software versions and feature sets for which they have purchased a license. By installing, downloading, accessing, or otherwise using such software upgrades, customers agree to follow the terms of the Cisco software license:
https://www.cisco.com/c/en/us/products/end-user-license-agreement.html ["https://www.cisco.com/c/en/us/products/end-user-license-agreement.html"]

Additionally, customers may only download software for which they have a valid license, procured from Cisco directly, or through a Cisco authorized reseller or partner. In most cases this will be a maintenance upgrade to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.

The Cisco Support and Downloads page ["https://www.cisco.com/c/en/us/support/index.html"] on Cisco.com provides information about licensing and downloads. This page can also display customer device support coverage for customers who use the My Devices tool.

When considering software upgrades ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories page ["https://www.cisco.com/go/psirt"], to determine exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.
  Customers Without Service Contracts
Customers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC: https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html ["https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html"]

Customers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.
      Fixed Releases
In the following table, the left column lists Cisco software releases. The right column indicates whether a release is affected by the vulnerability that is described in this advisory and the first release that includes the fix for this vulnerability. Customers are advised to upgrade to an appropriate fixed software release ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes"] as indicated in this section.
        Cisco ISE Release  First Fixed Release          2.7 and earlier  Not vulnerable      3.0  Not vulnerable      3.1  3.1P7      3.2  3.2P3      3.3  Not vulnerable
For instructions on upgrading a device, see the Upgrade Guides located on the Cisco ISE support page ["https://www.cisco.com/c/en/us/support/security/identity-services-engine/series.html"].

The Cisco Product Security Incident Response Team (PSIRT) validates only the affected and fixed release information that is documented in this advisory.</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco PSIRT is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="9">This vulnerability was found during the resolution of a Cisco TAC support case.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-radius-dos-W7cNn7gt</cvrf:URL>
      <cvrf:Description>Cisco Identity Services Engine RADIUS Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Type="Vendor" Name="Cisco">
      <Branch Type="Product Name" Name="Cisco Identity Services Engine Software">
        <FullProductName ProductID="CVRFPID-111903">Cisco Identity Services Engine Software </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Identity Services Engine RADIUS Service Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCwe47081</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCwe47081</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2023-20243</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-111903</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV3>
        <BaseScoreV3>8.6</BaseScoreV3>
        <VectorV3>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H</VectorV3>
      </ScoreSetV3>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no workarounds that address this vulnerability. However, several potential mitigations may help address this vulnerability.

To mitigate this vulnerability, customers can turn off RADIUS accounting on the network access device (NAD) sending the crafted packets to the Cisco ISE PSN. There may be other mitigations for this vulnerability for customers who cannot upgrade to a fixed release. To coordinate implementation of the mitigations, contact the Cisco Technical Assistance Center (TAC) ["https://www.cisco.com/go/tac/"].

While these mitigations have been deployed and were proven successful in a test environment, customers should determine the applicability and effectiveness in their own environment and under their own use conditions. Customers should be aware that any workaround or mitigation that is implemented may negatively impact the functionality or performance of their network based on intrinsic customer deployment scenarios and limitations. Customers should not deploy any workarounds or mitigations before first evaluating the applicability to their own environment and any impact to such environment.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-radius-dos-W7cNn7gt</URL>
        <Description>Cisco Identity Services Engine RADIUS Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
