<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20110928-xcpcupsxml</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.1</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2011-09-28T16:00:00</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2012-07-18T14:37:08</cvrf:Date>
        <cvrf:Description>Updated advisory metatags.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2011-09-28T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-07-18T14:37:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A denial of service (DoS) vulnerability exists in Jabber Extensible
Communications Platform (Jabber XCP) and Cisco Unified Presence. An
unauthenticated, remote attacker could exploit this vulnerability by sending
malicious XML to an affected server. Successful exploitation of this
vulnerability could cause elevated memory and CPU utilization, resulting in
memory exhaustion and process crashes. Repeated exploitation could result in a
sustained DoS condition. 

 There are no workarounds available to mitigate exploitation
of this vulnerability.

This advisory is posted at https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20110928-xcpcupsxml["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20110928-xcpcupsxml"].</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">The following versions of Cisco Unified Presence and Jabber Extensible
Communications Platform (Jabber XCP) are affected by the vulnerability in this
advisory. JabberNow appliances are also affected if they are running a
vulnerable version of Jabber XCP software.

Cisco Unified Presence
All versions of Cisco Unified Presence prior to 8.5(4) are affected by
the vulnerability in this advisory.

Jabber XCP and JabberNow Appliances
The following Jabber XCP software versions are affected by the
vulnerability in this advisory:


    
        
            
            Versions

            
            
            Builds

            
        
        
            
            2.X

            
            
            All builds

            
        
        
            
            3.X

            
            
            All builds

            
        
        
            
            4.X

            
            
            All builds

            
        
        
            
            5.0

            
            
            All builds

            
        
        
            
            5.1

            
            
            All builds

            
        
        
            
            5.2

            
            
            All builds

            
        
        
            
            5.4

            
            
            Prior to 5.4.0.27581

            
        
        
            
            5.8

            
            
            Prior to 5.8.1.27561

            
        
    





Note: JabberNow appliances that are running these
software versions are also affected by the vulnerability in this
advisory.

Determining Cisco Unified Presence Software Versions
To determine the running version of Cisco Unified Presence software,
issue the show version active command from the command line
interface. 

 The following example shows Cisco Unified Presence software
version 8.6.0:


admin: show version active
Active Master Version: 8.6.0.97041-43

Determining Jabber XCP Software Versions
To determine the running version of Jabber XCP software, find the
JABBER_VERSION in the
[JABBER_HOME]/var/cache/xcp_vars.sh file. 

 The following example shows Jabber XCP software version
5.8.1.17421:


JABBER_VERSION=5.8.1.17421
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="4">Jabber XCP and Cisco Unified Presence provide an open and extensible
platform that facilitates the secure exchange of availability and instant
messaging (IM) information. 

 The XML parsers in Jabber XCP (including JabberNow
appliances) and Cisco Unified Presence are vulnerable to the Exponential Entity
Expansion attack. This attack is also known as an XML Bomb
referring to an XML document that is valid according to the rules of an XML
schema yet results in the hanging or crash of the parser or underlying server.
The attack is often referred to as the Billion Laughs
Attack because many proof of concept examples caused XML parsers to
expand the string lol or ha up to a
billion times or until server resources were exhausted. 

 The attack combines certain properties of XML to create
valid but malicious XML using an extreme level of nested substitutions. When an
XML parser attempts to expand all the nested entities it quickly exhausts all
server resources.

 This technique will cause the XML parsers in Cisco Unified
Presence and Jabber XCP (including JabberNow appliances) to trigger high CPU
and memory usage resulting in process crashes. The attack affects both
client-to-server connections as well as server-to-server (federation)
links.

This vulnerability is documented in the following Cisco bug IDs:


    
    
    CSCtq78106
    ["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtq78106"]
    (
    registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only)
    
    
    
    CSCtq89842
    ["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtq89842"]
    (
    registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only)
    
    
    
    CSCtq88547
    ["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCtq88547"]
    (
    registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only)
    

This vulnerability was assigned Common Vulnerabilities and Exposures
(CVE) ID CVE-2011-3287 for Cisco bug ID CSCtq78106 and CVE ID CVE-2011-3288 for
Cisco bug IDs CSCtq89842 and CSCtq88547. 
</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">There are no available workarounds to mitigate this
vulnerability.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">When considering software upgrades, also consult
http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"]
and any subsequent advisories to determine exposure and a complete upgrade
solution. 

In all cases, customers should exercise caution to be
certain the devices to be upgraded contain sufficient memory and that current
hardware and software configurations will continue to be supported properly by
the new release. If the information is not clear, contact the Cisco Technical
Assistance Center (TAC) or your contracted maintenance provider for assistance.



    
        
            
            
            Cisco Unified Presence Software
            Version
            

            
            
            
            First Fixed Release
            

            
        
        
            
            All versions prior to 8.5(4)

            
            
            Upgrade to 8.5(4)

            
        
    





    
        
            
            
            Jabber XCP Software Version, Including JabberNow
            Appliances
            

            
            
            
            First Fixed Release
            

            
        
        
            
            Versions prior to 4.X

            
            
            These versions are vulnerable but are End of Life. No fixed
            software will be made available. Cisco highly recommends that customers using
            one of these versions migrate to a supported version.

            
        
        
            
            Versions 4.X - 5.2

            
            
            Migrate to 5.4.0.27581, 5.8.1.27561, or higher

            
        
        
            
            Version 5.4

            
            
            Upgrade to 5.4.0.27581, 5.8.1.27561, or higher

            
        
        
            
            Version 5.8

            
            
            Upgrade to 5.8.1.27561 or higher

            
        
    
</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">XML entity expansion attacks are well known, but Cisco PSIRT is not
aware of any public announcements or malicious use of the vulnerability against
the Cisco products in this advisory.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="9">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20110928-xcpcupsxml</cvrf:URL>
      <cvrf:Description>Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Unified Presence Server" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7333">Cisco Unified Presence Server </FullProductName>
      </Branch>
      <Branch Name="Cisco Jabber Extensible Communications Platform (Jabber XCP)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-111959">Cisco Jabber Extensible Communications Platform (Jabber XCP) </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</Title>
    <CVE>CVE-2011-3287</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-111959</ProductID>
        <ProductID>CVRFPID-7333</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C/CDP:N/TD:N/CR:ND/IR:ND/AR:ND</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no available workarounds to mitigate this
vulnerability.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20110928-xcpcupsxml</URL>
        <Description>Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
  <Vulnerability Ordinal="2" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</Title>
    <CVE>CVE-2011-3288</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-111959</ProductID>
        <ProductID>CVRFPID-7333</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C/CDP:N/TD:N/CR:ND/IR:ND/AR:ND</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>There are no available workarounds to mitigate this
vulnerability.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20110928-xcpcupsxml</URL>
        <Description>Jabber Extensible Communications Platform and Cisco Unified Presence XML Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
