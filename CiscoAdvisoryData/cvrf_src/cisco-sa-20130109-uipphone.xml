<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20130109-uipphone</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.4</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2013-01-09T15:49:48</cvrf:Date>
        <cvrf:Description>Initial public release</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2013-01-17T15:39:32</cvrf:Date>
        <cvrf:Description>Added information about Engineering Special release 9.3(1)-ES11.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.2</cvrf:Number>
        <cvrf:Date>2013-02-14T22:18:07</cvrf:Date>
        <cvrf:Description>Added information regarding the release of general service release 9.3(1)SR2.  Added additional hardening information to Details section.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.3</cvrf:Number>
        <cvrf:Date>2013-03-27T15:30:57</cvrf:Date>
        <cvrf:Description>Corrected Revision History table for Revision 1.2. Incorrect year had been given.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.4</cvrf:Number>
        <cvrf:Date>2014-11-03T21:48:48</cvrf:Date>
        <cvrf:Description>Updated Summary and Software Versions and Fixes Section to indicate the release of version 9.4(2), which remediates the core vulnerability.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2013-01-09T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2014-11-03T21:48:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">Cisco Unified IP Phones 7900 Series versions 9.3(1)SR1 and prior contain an arbitrary code execution vulnerability that could allow a local attacker to execute code or modify arbitrary memory with elevated privileges.



This vulnerability is due to a failure to properly validate input passed to kernel system calls from applications running in userspace. An attacker could exploit this issue by gaining local access to the device using physical access or authenticated access using SSH and executing an attacker-controlled binary that is designed to exploit the issue. Such an attack would originate from an unprivileged context.



Ang Cui initially reported the issue to the Cisco Product Security Incident Response Team (PSIRT). On November 6, 2012, the Cisco PSIRT disclosed this issue in Cisco bug ID CSCuc83860["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuc83860"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) Release Note Enclosure. Subsequently, Mr. Cui has spoken at several public conferences and has performed public demonstrations of a device being compromised and used as a listening device. 



Mitigations are available to help reduce the attack surface of affected devices. See the "Details" section of this security advisory and the accompanying Cisco Applied Mitigation Bulletin (AMB) for additional information. 



Update (November 3rd, 2014):

Updated software that resolves the vulnerability described in this document has been released.  This release is generally available and can be downloaded from the product-specific support areas on Cisco.com. The release version is 9.4(2).



This advisory is available at the following link:

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130109-uipphone["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130109-uipphone"]</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">The vulnerability affects the Cisco Unified IP Phones 7900 Series, also known as TNP phones.</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">The following Cisco Unified IP Phones 7900 Series devices are affected by the vulnerability documented in this advisory:


    
    Cisco Unified IP Phone 7906
    
    Cisco Unified IP Phone 7911G
    
    Cisco Unified IP Phone 7931G
    
    Cisco Unified IP Phone 7941G
    
    Cisco Unified IP Phone 7941G-GE
    
    Cisco Unified IP Phone 7942G
    
    Cisco Unified IP Phone 7945G
    
    Cisco Unified IP Phone 7961G
    
    Cisco Unified IP Phone 7961G-GE
    
    Cisco Unified IP Phone 7962G
    
    Cisco Unified IP Phone 7965G
    
    Cisco Unified IP Phone 7970G
    
    Cisco Unified IP Phone 7971G-GE
    
    Cisco Unified IP Phone 7975G
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">The following Cisco Unified IP Phones 7900 Series devices are not affected by the vulnerability documented in this advisory:


    
    Cisco Unified IP Phone 7902G
    
    Cisco Unified IP Phone 7905G
    
    Cisco Unified IP Phone 7910G
    
    Cisco Unified IP Phone 7912G
    
    Cisco Unified IP Phone 7940
    
    Cisco Unified IP Phone 7960
    
    Cisco Unified IP Phone 7985G
    
    Cisco Unified Wireless IP Phone 7920 Versions 1/2/3
    
    Cisco Unified Wireless IP Phone 7921G
    
    Cisco Unified Wireless IP Phone 7925G
    
    Cisco Unified Wireless IP Phone 7925G-EX
    
    Cisco Unified Wireless IP Phone 7926G
    
    Cisco Unified IP Conference Station 7935
    
    Cisco Unified IP Conference Station 7936
    
    Cisco Unified IP Conference Station 7937G



No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">Several models in the CiscoUnified IP Phones 7900 Series contain an input validation vulnerability that could allow a local, authenticated attacker to manipulate arbitrary areas of memory within the device. This is due to a failure to properly validate user-supplied parameters that are passed to kernel system calls. Multiple access vectors have been identified whereby an attacker could gain local access to the device. An attacker can accomplish this by gaining physical access to the device via the AUX port on the back of the device, or remotely by first authenticating to the device via SSH. After the Cisco Unified Communications Manager (CallManager) provisions the device, the remote access method is disabled by default.



Public Demonstrations



This issue has been publicly demonstrated at several venues. In each demonstration, the devices that are used appear to be unprovisioned phones running an affected version of the Cisco Unified IP Phone software. The demonstrations use a physical attack vector to compromise the phone via a local serial port to place a modified binary on the device, which could then be used to manipulate arbitrary regions of kernel memory by exploiting this issue.



In the demonstrations, the handset microphone is enabled while the handset is in the on-hook position (handset in the cradle). The high-gain area microphones on the TNP devices are electrically connected to the speakerphone active indicator and cannot be bypassed through software manipulation. On the 79x1 Series devices, the handset microphone is controlled by software and the General Purpose Input/Output (GPIO) channels on the audio codec, which allows the microphone to be activated and the display indicators on the handset to be bypassed.



The 79x2 and 79x5 Series devices are designed to provide additional protections by electrically connecting the handset microphone to the off-hook switch, which prevents the microphone from being activated without any indication.  



Postulated Remote Attacks



In addition to the physical attack vector, multiple network-based attacks have been postulated that leverage certain behaviors of the Cisco Unified IP Phone. Thus far, the attacks have been predicated on exploiting the use of TFTP. TFTP is an unsecured transport protocol that operates over UDP and is susceptible to spoofing attacks. Cisco recognizes that TFTP is unsecured and has enabled administrators to cryptographically secure phone configuration files transferred over TFTP in Cisco Unified Call Manager Version 5.0 and later. Additionally, in version 8.0(1) and all subsequent releases, Cisco instituted a secure-by-default policy. These releases sign device configuration files by default and disable both the SSH and web daemons on the phones. Signing and encrypting device configuration files prevents an attacker from tampering or replacing these files by spoofing a TFTP server or server response. This is accomplished by verifying the cryptographic signature of these file before they are used by a device.



In addition to these default protections, Cisco provides a comprehensive design guide for all voice network deployments. This includes suggested security feature configurations on intermediate and edge devices to prevent spoofed traffic from being passed on the voice network as well as the isolation and segregation of voice traffic from general network traffic. Security information for Cisco Unified Communications Manager Version 9.0 is available at the following link: http://www.cisco.com/en/US/docs/voice_ip_comm/cucm/srnd/9x/security.html["http://www.cisco.com/en/US/docs/voice_ip_comm/cucm/srnd/9x/security.html"]



Cisco recognizes that while a number of network, device, and configuration-based mitigations exist, there is no way to mitigate the physical attack vector on the affected devices. To this end, Cisco has conducted a phased remediation approach, which started with an intermediate Engineering Special software release for affected devices, that mitigates known attack vectors for the vulnerability documented in this advisory. This software release was available upon request from the Cisco Technical Assistance Center (TAC). Additional enhancements will follow in a Service Release that was posted on Cisco.com on February 14, 2013.  



The final remediation of this vulnerability has been made available as part of the 9.4(2) general availability software release for affected devices.  The software was posted to Cisco.com in September 2014.



This vulnerability is documented in Cisco bug ID CSCuc83860["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCuc83860"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2012-5445.



Software Hardening



Changes have been made to the affected software to harden it against unauthorized access. The following changes have been made:


    Disable the local console port on affected devices.
    
        This change removes the ability to gain access to the command line of an affected device by physically accessing the AUX/Console port on the phone.
    
    


    Remove the default user shell.
    
        The interactive Unix-like shell has been removed from the affected devices. If SSH has been enabled, and a user successfully authenticates, the only shells available are the debug and log options.
    
    

These changes have been documented in Cisco Bug ID CSCue04937["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCue04937"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only).



Additional hardening measures have been made in the 9.3(1)SR2 service release.  The following change has been made:


    SSH authorized_keys file is no longer sent to phones
    
        This change removes the ability to authenticate to a phone via SSH keys only.  When SSH is enabled, administrators will need to authenticate via Username and Password as defined in a device's profile.
    
    

These changes have been documented in Cisco Bug ID CSCue04970["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCue04970"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only).</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">Administrators are advised to read and implement the mitigations found in the following Applied Mitigation Bulletin. If Cisco Unified IP Phones are not deployed on a Cisco infrastructure, administrators should at minimum consider deploying encrypted configurations and ensuring that SSH has been disabled. Configuration files from Cisco Unified Communications Manager Version 8.0(1) and later are signed by default for all affected Cisco Unified IP Phones 7900 Series devices.

Additional mitigations that can be deployed on Cisco devices within the network are available in the companion document "Identifying and Mitigating Exploitation of the Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability" at the following link:

https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=27763["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=27763"]
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">Cisco has released software version 9.4(2) that remediates the vulnerability described in this document. Release notes for this update can be found here: Cisco Unified IP Phone 7900 Series Release 9.4(2)["http://www.cisco.com/c/en/us/td/docs/voice_ip_comm/cuipph/7900_series/firmware/9-4-2/english/releasenotes/P790_BK_73355F5F_00_7900-series-rn-942/P790_BK_73355F5F_00_7900-series-rn-942_chapter_00.html"]



When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution. 

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and  confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 
</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any malicious use of the vulnerability that is described in this advisory. 



This vulnerability was reported to Cisco by Ang Cui, Columbia University.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference>
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=27763</cvrf:URL>
      <cvrf:Description>Identifying and Mitigating Exploitation of the Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability</cvrf:Description>
    </cvrf:Reference>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130109-uipphone</cvrf:URL>
      <cvrf:Description>Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Unified IP Phone 7906G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7655">Cisco Unified IP Phone 7906G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7911G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7656">Cisco Unified IP Phone 7911G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7941G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7657">Cisco Unified IP Phone 7941G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7961G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7658">Cisco Unified IP Phone 7961G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7970G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-7659">Cisco Unified IP Phone 7970G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7931G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-73426">Cisco Unified IP Phone 7931G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7942G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-73458">Cisco Unified IP Phone 7942G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7962G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-73464">Cisco Unified IP Phone 7962G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7945G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-73470">Cisco Unified IP Phone 7945G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7965G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-73476">Cisco Unified IP Phone 7965G </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7971G-GE" Type="Product Name">
        <FullProductName ProductID="CVRFPID-109904">Cisco Unified IP Phone 7971G-GE </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7961G-GE" Type="Product Name">
        <FullProductName ProductID="CVRFPID-109994">Cisco Unified IP Phone 7961G-GE </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7941G-GE" Type="Product Name">
        <FullProductName ProductID="CVRFPID-109995">Cisco Unified IP Phone 7941G-GE </FullProductName>
      </Branch>
      <Branch Name="Cisco Unified IP Phone 7975G" Type="Product Name">
        <FullProductName ProductID="CVRFPID-188519">Cisco Unified IP Phone 7975G </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Unified IP Phones Local Kernel System Call Input Validation Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCuc83860</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCuc83860</Note>
    </Notes>
    <CVE>CVE-2012-5445</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-109904</ProductID>
        <ProductID>CVRFPID-109994</ProductID>
        <ProductID>CVRFPID-109995</ProductID>
        <ProductID>CVRFPID-188519</ProductID>
        <ProductID>CVRFPID-73426</ProductID>
        <ProductID>CVRFPID-73458</ProductID>
        <ProductID>CVRFPID-73464</ProductID>
        <ProductID>CVRFPID-73470</ProductID>
        <ProductID>CVRFPID-73476</ProductID>
        <ProductID>CVRFPID-7655</ProductID>
        <ProductID>CVRFPID-7656</ProductID>
        <ProductID>CVRFPID-7657</ProductID>
        <ProductID>CVRFPID-7658</ProductID>
        <ProductID>CVRFPID-7659</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>6.8</BaseScoreV2>
        <TemporalScoreV2>5.8</TemporalScoreV2>
        <VectorV2>AV:L/AC:L/Au:S/C:C/I:C/A:C/E:F/RL:TF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>Administrators are advised to read and implement the mitigations found in the following Applied Mitigation Bulletin. If Cisco Unified IP Phones are not deployed on a Cisco infrastructure, administrators should at minimum consider deploying encrypted configurations and ensuring that SSH has been disabled. Configuration files from Cisco Unified Communications Manager Version 8.0(1) and later are signed by default for all affected Cisco Unified IP Phones 7900 Series devices.

Additional mitigations that can be deployed on Cisco devices within the network are available in the companion document "Identifying and Mitigating Exploitation of the Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability" at the following link:

https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=27763["https://sec.cloudapps.cisco.com/security/center/viewAMBAlert.x?alertId=27763"]
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130109-uipphone</URL>
        <Description>Cisco Unified IP Phone Local Kernel System Call Input Validation Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
