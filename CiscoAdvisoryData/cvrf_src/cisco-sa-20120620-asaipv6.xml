<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco ASA 5500 Series Adaptive Security Appliances and Cisco Catalyst 6500 Series ASA Services Module Denial of Service Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20120620-asaipv6</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2012-06-20T03:13:25</cvrf:Date>
        <cvrf:Description>Initial public release</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2012-06-20T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-06-20T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">Cisco ASA 5500 Series Adaptive Security Appliances (Cisco ASA) and Cisco
Catalyst 6500 Series ASA Services Module (Cisco ASASM) contain a vulnerability that may allow an unauthenticated, remote
attacker to cause the reload of the affected device.



Cisco has released software updates that address this vulnerability. Workarounds that mitigate this vulnerability are available. This advisory is available at the following link:

https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120620-asaipv6["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120620-asaipv6"]</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">Cisco ASA and Cisco ASASM are affected by this vulnerability. Not all the versions of Cisco ASA Software are affected by this vulnerability. Consult the "Software Versions
and Fixes" section of this security advisory for more information about
the affected version.</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">For specific version information, refer to the "Software Versions and Fixes" section of this advisory.



Cisco ASA and Cisco ASASM contain a vulnerability that may allow an unauthenticated, remote
attacker to cause the reload of the affected device.



Cisco ASA Software may be affected by this vulnerability if all the following conditions are present: 


    Cisco ASA or Cisco ASASM is running in transparent firewall mode
    Cisco ASA or Cisco ASASM has IPv6 enabled 
    Cisco ASA or Cisco ASASM has system logging enabled and the system is configured to log message ID 110003

To verify that the Cisco ASA or Cisco ASASM is running in transparent firewall mode, issue the show firewall command. The following example shows a Cisco ASA running in transparent firewall mode: 


ciscoasa# show firewall
Firewall mode: Transparent

IPv6 is not enabled by default. In order to enable IPv6 on a Cisco ASA or Cisco ASASM configured in transparent firewall mode at a minimum a link-local
address needs to be configured for IPv6 to operate correctly. If a global address is configured, a
link-local address is automatically configured on each interface. 



To verify that the Cisco ASA or Cisco ASASM has IPv6 enabled, issue the show ipv6 interface command and confirm that the command returns output. The following example shows a Cisco ASA configured with two interfaces (inside and outside) running in transparent firewall mode and IPv6 enabled:




ciscoasa# show ipv6 interface
outside is up, line protocol is up
  IPv6 is enabled, link-local address is fe80::219:2fff:fe83:4f42
  No global unicast address is configured
  Joined group address(es):
    ff02::1
    ff02::1:ff83:4f42
  ICMP error messages limited to one every 100 milliseconds
  ICMP redirects are enabled
  ND DAD is enabled, number of DAD attempts: 1
  ND reachable time is 30000 milliseconds
  ND advertised retransmit interval is 1000 milliseconds
  Hosts use stateless autoconfig for addresses.
inside is up, line protocol is up
  IPv6 is enabled, link-local address is fe80::219:2fff:fe83:4f43
  No global unicast address is configured
  Joined group address(es):
    ff02::1
    ff02::1:ff83:4f43
  ICMP error messages limited to one every 100 milliseconds
  ICMP redirects are enabled
  ND DAD is enabled, number of DAD attempts: 1
  ND reachable time is 30000 milliseconds
  ND advertised retransmit interval is 1000 milliseconds
  Hosts use stateless autoconfig for addresses.
Syslog
message ID 110003 is generated when the Cisco ASA is unable to find the next hop on an interface routing table. Additional information
regarding this syslog message can be found in the Cisco ASA System Log
Messages guide at: http://www.cisco.com/en/US/products/ps6120/products_system_message_guides_list.html["http://www.cisco.com/en/US/products/ps6120/products_system_message_guides_list.html"].
Logging is not enabled by default on a Cisco ASA; however, when logging
is enabled a Cisco ASA will automatically enable syslog message 110003.



Syslog message 110003 has a default severity level of 6 (informational). Cisco
ASA Software configured for logging at Level 6 or higher (that is Levels 6 through 7) may be vulnerable.

To verify if logging is enabled, issue the show logging command. The following example shows a Cisco ASA with logging enabled and buffer logging enabled at Level 6 (informational):


ciscoasa# show logging
Syslog logging: enabled
    Facility: 20
    Timestamp logging: disabled
    Standby logging: disabled
    Debug-trace logging: disabled
    Console logging: disabled
    Monitor logging: disabled
    Buffer logging: level informational, 2 messages logged
    Trap logging: disabled
    Permit-hostdown logging: disabled
    History logging: disabled
    Device ID: disabled
    Mail logging: disabled
    ASDM logging: disabled


Using a custom message list (created via the logging list
command) that includes syslog message 110003, either by severity or by
explicitly including the message ID, is also a vulnerable configuration.




The default severity level of syslog messages can be changed. If the
default severity level of syslog message 110003 is changed and the
device is configured to log to any destination at the new severity
level, the device is vulnerable.
Determine the Running Software Version
To determine whether a vulnerable version of Cisco ASA Software is running on an appliance, administrators can issue the show version
command. The following example shows a Cisco ASA 5500 Series Adaptive
Security Appliance that is running software version 8.4(1):


ciscoasa#show version | include Version
Cisco Adaptive Security Appliance Software Version 8.4(1) 
Device Manager Version 6.4(1)

Customers who use Cisco Adaptive Security Device Manager (ASDM) to
manage devices can locate the software version in the table that is
displayed in the login window or upper-left corner of the Cisco ASDM
window.

Information about Cisco PIX Security Appliance
Cisco PIX is not affected by the vulnerability described in
this security advisory. Cisco PIX has reached end of maintenance
support. Cisco PIX customers are encouraged to migrate to Cisco ASA. 
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">Cisco ASA 5500 Series Adaptive Security Appliances (Cisco ASA) and Cisco
Catalyst 6500 Series ASA Services Module (Cisco ASASM) contain a vulnerability that may allow an unauthenticated, remote
attacker to cause a reload of the affected device. 



Note: This vulnerability can only be triggered by IPv6 transit traffic, and affects both Cisco ASA and Cisco ASASM when configured in transparent firewall mode (either single or multiple context mode).



This vulnerability is documented in Cisco bug ID CSCua27134["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCua27134"] (registered["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and has been assigned Common Vulnerabilities and Exposures (CVE) ID CVE-2012-3058.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">A valid workaround is to prevent the Cisco ASA from generating the syslog message 110003. Use the no logging message 110003 command to disable syslog message 110003. 

To verify that the message is not being generated issue show running-configuration logging command. The following example shows the output of the command when the logging of message 110003 is disabled:


ciscoasa# show run logging
[...]
no logging message 110003
[...]
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution. 

In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and  confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers. 


    
        
            Vulnerability
            Major Release

            
            
            First Fixed Release

            
            
        
        
            Cisco ASA IPv6 Packets Denial Of Service Vulnerability

            
            7.0
            Not Affected

            
        
        
            7.1
            Not Affected

            
        
        
            7.2
            Not Affected
        
        
            8.0
            Not Affected 
        
        
            8.1
            Not Affected 
        
        
            8.2
            Not Affected 
        
        
            8.3
            Not Affected 
        
        
            8.41
            8.4(4.1)
        
        
            8.5
            8.5(1.11); Available July 2012
        
        
            8.6
            8.6 (1.3); Available July 2012

            
        
    



1This vulnerability was introduced in 8.4(2). Versions prior to 8.4(2) are not affected by this vulnerability</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 

This vulnerability was discovered during the resolution of a service request.
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120620-asaipv6</cvrf:URL>
      <cvrf:Description>Cisco ASA 5500 Series Adaptive Security Appliances and Cisco Catalyst 6500 Series ASA Services Module Denial of Service Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Adaptive Security Appliance (ASA) Software" Type="Product Name">
        <Branch Name="8.4" Type="Product Version">
          <Branch Name="8.4.2" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-112139">Cisco Adaptive Security Appliance (ASA) Software 8.4.2</FullProductName>
          </Branch>
          <Branch Name="8.4.2.8" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115255">Cisco Adaptive Security Appliance (ASA) Software 8.4.2.8</FullProductName>
          </Branch>
          <Branch Name="8.4.3" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115256">Cisco Adaptive Security Appliance (ASA) Software 8.4.3</FullProductName>
          </Branch>
          <Branch Name="8.4.3.8" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115264">Cisco Adaptive Security Appliance (ASA) Software 8.4.3.8</FullProductName>
          </Branch>
          <Branch Name="8.4.3.9" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115265">Cisco Adaptive Security Appliance (ASA) Software 8.4.3.9</FullProductName>
          </Branch>
          <Branch Name="8.4.4" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115266">Cisco Adaptive Security Appliance (ASA) Software 8.4.4</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="8.5" Type="Product Version">
          <Branch Name="8.5.1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-112136">Cisco Adaptive Security Appliance (ASA) Software 8.5.1</FullProductName>
          </Branch>
          <Branch Name="8.5.1.1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-112140">Cisco Adaptive Security Appliance (ASA) Software 8.5.1.1</FullProductName>
          </Branch>
          <Branch Name="8.5.1.6" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115269">Cisco Adaptive Security Appliance (ASA) Software 8.5.1.6</FullProductName>
          </Branch>
          <Branch Name="8.5.1.7" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115270">Cisco Adaptive Security Appliance (ASA) Software 8.5.1.7</FullProductName>
          </Branch>
        </Branch>
        <Branch Name="8.6" Type="Product Version">
          <Branch Name="8.6.1.1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115268">Cisco Adaptive Security Appliance (ASA) Software 8.6.1.1</FullProductName>
          </Branch>
          <Branch Name="8.6.1" Type="Service Pack">
            <FullProductName ProductID="CVRFPID-115276">Cisco Adaptive Security Appliance (ASA) Software 8.6.1</FullProductName>
          </Branch>
        </Branch>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco ASA IPv6 Packets Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCua27134</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCua27134</Note>
    </Notes>
    <CVE>CVE-2012-3058</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-112136</ProductID>
        <ProductID>CVRFPID-112139</ProductID>
        <ProductID>CVRFPID-112140</ProductID>
        <ProductID>CVRFPID-115255</ProductID>
        <ProductID>CVRFPID-115256</ProductID>
        <ProductID>CVRFPID-115264</ProductID>
        <ProductID>CVRFPID-115265</ProductID>
        <ProductID>CVRFPID-115266</ProductID>
        <ProductID>CVRFPID-115268</ProductID>
        <ProductID>CVRFPID-115269</ProductID>
        <ProductID>CVRFPID-115270</ProductID>
        <ProductID>CVRFPID-115276</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>A valid workaround is to prevent the Cisco ASA from generating the syslog message 110003. Use the no logging message 110003 command to disable syslog message 110003. 

To verify that the message is not being generated issue show running-configuration logging command. The following example shows the output of the command when the logging of message 110003 is disabled:


ciscoasa# show run logging
[...]
no logging message 110003
[...]
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120620-asaipv6</URL>
        <Description>Cisco ASA 5500 Series Adaptive Security Appliances and Cisco Catalyst 6500 Series ASA Services Module Denial of Service Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
