<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Mobility Services Engine Static Credential Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20151104-mse-cred</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2015-11-04T15:01:59</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2015-11-04T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2015-11-04T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the Cisco Mobility Services Engine (MSE) could allow an unauthenticated, remote attacker to log in to the MSE with the default oracle account. This account does not have full administrator privileges.



The vulnerability is due to a user account that has a default and static password. This account is created at installation and cannot be changed or deleted without impacting the functionality of the system. An attacker could exploit this vulnerability by remotely connecting to the affected system via SSH using this account. A successful exploit could allow the attacker to log in to the MSE using the default oracle account.


Cisco has released software updates that address this vulnerability. A workaround that mitigates this vulnerability is available.



This advisory is available at the following link: https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-mse-cred["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-mse-cred"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">Cisco Mobility Services Engine (MSE) versions 8.0.120.7 and earlier are vulnerable. Administrators can use a command to determine whether a vulnerable version of Cisco MSE is running. Prior to 10.0, the command is getserverinfo. For 10.0 and later, the command is cmxctl version. The following examples show an MSE running versions 8.0.120.1 and 10.2.0:



[mse]# getserverinfo 

Health Monitor is running

Retrieving MSE Services status.

MSE services are up, getting the status



-------------

Server Config

-------------



Product name: Cisco Mobility Service Engine

Version: 8.0.120.1

Health Monitor Ip Address: 1.1.1.1

High Availability Role: 1

Hw Version: V01

Hw Product Identifier: AIR-MSE-3365-K9

Hw Serial Number: FCH1841V0YL



[mse]# cmxctl version

----------------------------------------------------------------------

Build Version   : 10.2.0

Build Time       : 2015-10-19 11:20:06.632222

----------------------------------------------------------------------</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Indicators of Compromise" Type="General" Ordinal="4">The oracle account is a reserved account used for internal MSE operations. This account should not be used for SSH interactive logins. When reviewing authentication, authorization, and accounting (AAA) server log files, if there is an SSH login via the oracle account, this is an indicator that this vulnerability has been exploited on the affected device. The compromise can be determined if there is any output from this command:



 mse&gt; grep "user oracle" /var/log/secure* | grep "sshd:session"


This command should return no output if the oracle account has not been logged into via SSH.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">The following is a workaround to disable SSH login for the oracle user account on the MSE:



1. Log in to the MSE as user root.

2. Edit the file /etc/ssh/sshd_config via a text editor. 

3. Navigate to the bottom of the file and add the following line:

   
DenyUsers oracle


   This instructs the SSH service to not allow SSH logins for the oracle user. 

   Note: This change only takes effect after the SSH service is restarted.



4. Save the updated /etc/ssh/sshd_config file.

5. Restart the SSH service with the service sshd restart command.

6. To verify that the workaround is properly configured, attempt an SSH login to the MSE as the oracle user. 

    This login attempt should fail with the error .   

     
ssh ���l oracle 


     Try an SSH login to the MSE as the root user. This login attempt should succeed.

   
 ssh -l root 


Note: This workaround configuration is persistent and only needs to be applied once.</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution.

In all cases, customers should ensure that the devices to upgrade contain sufficient memory and  confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.



The following advisories are part of the November 2015 Cisco MSE Security Advisory Companion Publications: 


    cisco-sa-20151104-mse-cred["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-mse-cred"]
    cisco-sa-20151104-privmse["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-privmse"]

Software Download 




The Cisco MSE Static Credential Vulnerability is fixed in all versions after 8.0.120.7. The latest Cisco MSE software can be downloaded from the Software Center on Cisco.com by visiting http://www.cisco.com/cisco/software/navigator.html["http://www.cisco.com/cisco/software/navigator.html"] and selecting:



 Products &gt; Wireless &gt; Mobility Services &gt; Mobility Services Engine

</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.
</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="9">Cisco would like to thank security researcher Jeremy Brown and Beyond Security���s SecuriTeam Secure Disclosure (SSD) group for discovering and reporting this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-mse-cred</cvrf:URL>
      <cvrf:Description>Cisco Mobility Services Engine Static Credential Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Mobility Services Engine" Type="Product Name">
        <FullProductName ProductID="CVRFPID-111803">Cisco Mobility Services Engine </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Mobility Services Engine Static Credential Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCuv40501</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCuv40501</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2015-6316</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-111803</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>6.5</BaseScoreV2>
        <TemporalScoreV2>5.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>The following is a workaround to disable SSH login for the oracle user account on the MSE:



1. Log in to the MSE as user root.

2. Edit the file /etc/ssh/sshd_config via a text editor. 

3. Navigate to the bottom of the file and add the following line:

   
DenyUsers oracle


   This instructs the SSH service to not allow SSH logins for the oracle user. 

   Note: This change only takes effect after the SSH service is restarted.



4. Save the updated /etc/ssh/sshd_config file.

5. Restart the SSH service with the service sshd restart command.

6. To verify that the workaround is properly configured, attempt an SSH login to the MSE as the oracle user. 

    This login attempt should fail with the error .   

     
ssh ���l oracle 


     Try an SSH login to the MSE as the root user. This login attempt should succeed.

   
 ssh -l root 


Note: This workaround configuration is persistent and only needs to be applied once.</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-mse-cred</URL>
        <Description>Cisco Mobility Services Engine Static Credential Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
