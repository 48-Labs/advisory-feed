<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Nexus 1000V Series Switch Software Release 4.2(1)SV1(5.2) Virtual Security Gateway Bypass Issue</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20121107-n1k</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Interim</cvrf:Status>
    <cvrf:Version>1.0</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2012-11-07T15:42:48</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2012-11-07T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-11-07T16:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">The Cisco Product Security Incident Response Team (PSIRT) would like to notify customers of an issue that may impact their network security posture when upgrading the Cisco Nexus 1000V Series Switches to Software Release 4.2(1)SV1(5.2) with deployments that have Cisco Virtual Security Gateway (VSG) integration. This issue will manifest itself when administrators perform an in-service software upgrade to Software Release 4.2(1)SV1(5.2) from Software Release 4.2(1)SV1(5.1a) or earlier.

After the software upgrade, a bug in Software Release 4.2(1)SV1(5.2) could cause all the virtual Ethernet ports on the Virtual Ethernet Modules (VEM) of the Cisco Nexus 1000V Series Switch to stay in No-Policy pass-through mode because a valid VSG license is not actively installed. As a result, the VEMs no longer use a configured Cisco VSG; therefore, the virtual machines (VM) are not firewalled and traffic is not inspected by the VSG.

This software bug is documented in Cisco Bug ID CSCud01427 ["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCud01427"] (registered ["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only) and a software bulletin for Software Release 4.2(1)SV1(5.2) is in the process of being published.

Additional Information
Problem Symptoms

The VEM is in unlicensed mode for VSG, while the Virtual Supervisor Module (VSM) of Cisco Nexus 1000V continues to show it licensed.

Conditions

This issue affects deployments that have Cisco VSG integration with Cisco Nexus 1000V Series Switches. This issue occurs after upgrading the VSM of Cisco Nexus 1000V Series Switches to Software Release 4.2(1)SV1(5.2) from Software Release 4.2(1)SV1(5.1a) or earlier.

After an upgrade, the device can enter a state whereby it has active VEM ports but a license is not installed for the VSG, even when the device is configured with permanent VSG licenses. When this occurs, all the virtual Ethernet ports on the VEM that correspond to the VMs are kept in pass-through mode, with traffic not being analyzed by the VSG and hence any policies configured on the VSG are not enforced.

This bug is independent of VSM-to-VEM communication (whether in Layer 2 or Layer 3 mode).

Identification

If the workaround as described below is followed, then this issue will not be seen, and the licenses will be correctly installed.

After the upgrade to Software Release 4.2(1)SV1(5.2) has been performed, this issue can be verified from the command-line interface by issuing the command-line interface (CLI) command show vsn detail. In the following example, the VSN-STATE indicates No-License:
nexus1K# show vsn detail
#VSN  VLAN: -, IP-ADDR: 192.168.0.1
MODULE       VSN-MAC-ADDR  FAIL-MODE   VSN-STATE
3                  -      Close  No-License
4                  -      Close  No-License
  Workaround

When upgrading a Cisco Nexus 1000V Series Switch to Software Release 4.2(1)SV1(5.2), the administrator should perform these additional steps:
      After the VSM upgrade is complete, but before the VEM upgrade is initiated, use the system switchover command to initiate a manual switchover. After the switchover, the CLI session will exit.      Login to the VSM and use the show redundancy status CLI command to verify the switchover was successful.
  After the VSM and VEM has been upgraded, use the show vsn detail command to validate the licenses were properly installed. The VSN-STATE should be Up. If the VSM and VEM were upgraded successfully and the licenses were properly installed, then this issue will not be observed.

Official Fix

Cisco will release Software Release 4.2(1)SV1(5.2a) and this response will be updated when a confirmed release date is available.

Cisco Security Procedures
Complete information on reporting security vulnerabilities in Cisco  products, obtaining assistance with security incidents, and registering to  receive security information from Cisco, is available on Cisco's worldwide  website at  https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html"].  This includes instructions for press inquiries regarding Cisco security  notices. All Cisco security advisories are available at  http://www.cisco.com/go/psirt ["http://www.cisco.com/go/psirt"].</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="2">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="3">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME. CISCO EXPECTS TO UPDATE THIS DOCUMENT AS NEW INFORMATION BECOMES AVAILABLE.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20121107-n1k</cvrf:URL>
      <cvrf:Description>Cisco Nexus 1000V Series Switch Software Release 4.2(1)SV1(5.2) Virtual Security Gateway Bypass Issue</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Nexus 1000V Series Switch Software Release 4.2(1)SV1(5.2) Virtual Security Gateway Bypass Issue</Title>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20121107-n1k</URL>
        <Description>Cisco Nexus 1000V Series Switch Software Release 4.2(1)SV1(5.2) Virtual Security Gateway Bypass Issue</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
