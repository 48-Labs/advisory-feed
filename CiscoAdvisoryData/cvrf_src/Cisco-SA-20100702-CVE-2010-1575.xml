<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco CSS Content Services Switch and ACE Application Control Engine HTTP SSL Header Spoofing Vulnerability</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>Cisco-SA-20100702-CVE-2010-1575</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>3.0</cvrf:Version>
    <cvrf:RevisionHistory />
    <cvrf:InitialReleaseDate>2010-07-02T14:15:24</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-07-14T14:00:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">Cisco CSS Content Services Switch (CSS), SSL Services Module (SSLM), and ACE Application Control Engine (ACE) contain a vulnerability that could allow an authenticated, remote attacker to insert spoofed SSL headers into HTTP requests.

The vulnerability exists because the affected products weakly enforce authority in HTTP certificate headers when performing SSL session termination. An authenticated, remote attacker could exploit this vulnerability by inserting spoofed SSL certificate headers into requests that are passed to the affected products for SSL termination. If successful, an attacker might be able to perform man-in-the-middle attacks, gaining access to sensitive information.

Cisco has confirmed this vulnerability in software release notes and released updated software.





This vulnerability could affect any CSS or SSLM installation, but could have a greater impact on installations configured to perform client certificate validation through the following configuration statement on the CSS: ssl-server &lt; CONTEXT &gt;http-header client-cert and the following ssl-proxy policy http-header configuration statement on the SSLM: client-cert.

Ultimately, the impact of this vulnerability will depend on the applications behind an affected CSS device and how those devices handle the presence of multiple SSL headers throughout HTTP requests.  If the applications process the last headers that appear in the request, they will receive those added by the CSS, but any other handling of SSL headers could result in the processing of the wrong headers.
</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">The CSS behavior is documented in Cisco bug ID CSCsz04690["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCsz04690"]

Cisco thanks Virtual Security Research, LLC, George D. Gal researcher for reporting this issue.
</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">This vulnerability affects Cisco CSS devices, SSLM, and ACE modules.  SSL header insertion first appeared in version A2(3.0) for the ACE module; ACE appliances do not perform header insertion and are not affected.

CSS devices running version 8.10.6.03S or later, or 8.20.4.03S or later can be configured to first remove HTTP headers in requests before appending the CSS's own headers. The default configuration in these versions is not to remove these headers, but if configured with ssl pre-remove-http-hdr they are not affected.
</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">No other Cisco products are currently known to be affected by these vulnerabilities.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">On the CSS, the ssl-server &lt; CONTEXT &gt;http-header prefix &lt; RANDOM_PREFIX &gt; command will further secure the headers from the spoofing exposure by allowing a server administrator to define a random header prefix that will be prepended to new client certificates.

Usage and configuration of this command for the CSS is documented in the CSS Command Reference["http://www.cisco.com/en/US/docs/app_ntwk_services/data_center_app_services/css11500series/v8.20/command/reference/CmdSSLC.html#wp1172789"].

On the SSLM, the following ssl-proxy policy http-header configuration statement will insert a configured prefix that will be prepended to the SSLM-inserted headers: prefix 
&lt; prefix &gt;.  Also on the SSLM, the header names may be changed via the following ssl-proxy policy http-header configuration statement: alias &lt; alias string &gt; &lt; header name &gt;.

Use and configuration of this command for the SSLM are documented in the SSL Services Module Command Reference["http://www.cisco.com/en/US/docs/interfaces_modules/services_modules/ssl/2.1/command/reference/comref.html"].

In addition, with CSS releases 8.20.4.03S and 8.10.6.03S, the following new command has been implemented: ssl pre-remove-http-hdr. This command will remove existing headers prior to inserting a new header. For example, if the software is configured for client certificate information, this command would cause existing client certificate headers to be removed and then the new headers would be inserted. Note that this functionality does not work with prefixes. The default behavior will continue to ignore headers before insertion. The no ssl pre-remove-http-hdr command reverts to default behavior. This command may impact CSS performance based on the number of headers present.

SSL header insertion was first implemented in the ACE module with version A2(3.0). SSL header insertion functionality does not exist in the ACE appliance.

The ACE module allows header deletion and rewrite as documented in the ACE Configuration Guide for software version A2(3.0)["http://www.cisco.com/en/US/partner/docs/interfaces_modules/services_modules/ace/vA2_3_0/configuration/slb/guide/classlb.html#wp1131850"].
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">Cisco customers can obtain upgrades by contacting the Cisco Technical Assistance Center at 1-800-553-2447 or 1-408-526-7209 or via e-mail at tac@cisco.com.

</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory. 
</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="9">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20100702-CVE-2010-1575</cvrf:URL>
      <cvrf:Description>Cisco CSS Content Services Switch and ACE Application Control Engine HTTP SSL Header Spoofing Vulnerability</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Content Services Switch (CSS)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-2082">Cisco Content Services Switch (CSS) </FullProductName>
      </Branch>
      <Branch Name="Cisco SSL Services Module" Type="Product Name">
        <FullProductName ProductID="CVRFPID-5448">Cisco SSL Services Module </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Content Services Switch and Application Control Engine HTTP SSL Header Spoofing Vulnerability</Title>
    <CVE>CVE-2010-1575</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-2082</ProductID>
        <ProductID>CVRFPID-5448</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>3.5</BaseScoreV2>
        <TemporalScoreV2>3.2</TemporalScoreV2>
        <VectorV2>AV:N/AC:M/Au:S/C:N/I:P/A:N/E:F/RL:W/RC:C/CDP:N/TD:N/CR:ND/IR:ND/AR:ND</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>On the CSS, the ssl-server &lt; CONTEXT &gt;http-header prefix &lt; RANDOM_PREFIX &gt; command will further secure the headers from the spoofing exposure by allowing a server administrator to define a random header prefix that will be prepended to new client certificates.

Usage and configuration of this command for the CSS is documented in the CSS Command Reference["http://www.cisco.com/en/US/docs/app_ntwk_services/data_center_app_services/css11500series/v8.20/command/reference/CmdSSLC.html#wp1172789"].

On the SSLM, the following ssl-proxy policy http-header configuration statement will insert a configured prefix that will be prepended to the SSLM-inserted headers: prefix 
&lt; prefix &gt;.  Also on the SSLM, the header names may be changed via the following ssl-proxy policy http-header configuration statement: alias &lt; alias string &gt; &lt; header name &gt;.

Use and configuration of this command for the SSLM are documented in the SSL Services Module Command Reference["http://www.cisco.com/en/US/docs/interfaces_modules/services_modules/ssl/2.1/command/reference/comref.html"].

In addition, with CSS releases 8.20.4.03S and 8.10.6.03S, the following new command has been implemented: ssl pre-remove-http-hdr. This command will remove existing headers prior to inserting a new header. For example, if the software is configured for client certificate information, this command would cause existing client certificate headers to be removed and then the new headers would be inserted. Note that this functionality does not work with prefixes. The default behavior will continue to ignore headers before insertion. The no ssl pre-remove-http-hdr command reverts to default behavior. This command may impact CSS performance based on the number of headers present.

SSL header insertion was first implemented in the ACE module with version A2(3.0). SSL header insertion functionality does not exist in the ACE appliance.

The ACE module allows header deletion and rewrite as documented in the ACE Configuration Guide for software version A2(3.0)["http://www.cisco.com/en/US/partner/docs/interfaces_modules/services_modules/ace/vA2_3_0/configuration/slb/guide/classlb.html#wp1131850"].
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/Cisco-SA-20100702-CVE-2010-1575</URL>
        <Description>Cisco CSS Content Services Switch and ACE Application Control Engine HTTP SSL Header Spoofing Vulnerability</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
