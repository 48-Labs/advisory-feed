<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Guard Enables Cross Site Scripting</cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20060920-guardxss</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.1</cvrf:Version>
    <cvrf:RevisionHistory />
    <cvrf:InitialReleaseDate>2006-09-20T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2012-01-02T12:18:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the Cisco Guard may enable an attacker to send a web  browser client to a malicious website with the use of Cross Site Scripting  (XSS) when the Guard is providing anti-spoofing services between the web  browser client and a webserver. The attacker may exploit this by providing a  malicious URL for the web browser client to go to, often in email, followed off  of a malicious website, or in an instant message. This issue may occur even if  the protected website does not allow XSS. A software upgrade is required to fix  this vulnerability. There is a workaround available to mitigate the effects of  the vulnerability.

This advisory is available at  https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20060920-guardxss ["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20060920-guardxss"].</cvrf:Note>
    <cvrf:Note Title="Affected Products" Type="General" Ordinal="2">This section provides details on affected products.</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="3">The following Cisco products are vulnerable.

   Cisco Guard Appliance (Software Version 3.X)

   Cisco Guard Blade (Software Version 4.X)

   Cisco Guard Appliance [Software Version 5.0(3)]

   Cisco Guard Appliance [Software Version 5.1(5)]</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="4">No other Cisco products have been found to be vulnerable.

There are three ways to determine the software version that your Cisco  Guard DDoS mitigation appliance is running. An example of each method is shown  here:

   Virtual terminal or local serial console connection
To determine the software version number through the local serial console use a serial cable and a terminal emulation program to connect to the appliance. Once you are connected, press the Enter key of your terminal and the Guard will present, without even logging in, the version of the software running on the devices:
Cisco Guard Version 3.1(0.12)
 GUARD login:
    In this example the Cisco Guard is running software version 3.1.
For a virtual terminal, the procedure is the same except that no serial cable or terminal emulation program is needed (a standard keyboard and monitor are directly connected to the appliance).

   Remote Secure Shell (SSH) connection
To obtain the software version number through a SSH session, use a SSH client to log in to the Cisco Guard and issue the show version command-line interface (CLI) command.
prompt$ ssh admin@guard.example.com
admin@guard.example.com's password: Last login: Wed Nov 24 22:45:53 on ttyS0 admin@GUARD#show version Copyright (c) 2000-2004 Cisco Systems, Inc. All rights reserved.  Software License Agreement  [...]  Cisco Anomaly Guard Release: 3.1(0.12) Date:    2004/10/27 19:58:14  GUARD uptime is 3 weeks, 3 days, 17 hours, 53 minutes System Serial Number:  XXXXXXX
    In this example, the Cisco Traffic Anomaly Guard is running software version 3.1.

   Remote secure web session
To obtain the software version that Cisco Guard is running through a secure web interface, open the URL https://IP address of your Guard/ in a web browser, log in, and then click on the About link located on the top right section of the browser window.</cvrf:Note>
    <cvrf:Note Title="Details" Type="General" Ordinal="5">The Cisco Guard DDoS Mitigation Appliance is a distributed  denial-of-service (DDoS) protection system. Malicious DOS traffic is identified  with a Cisco Detector and diverted to the Guard for attack mitigation. Under  normal circumstances, the Guard plays no role in valid traffic; it is  specifically designed to deal with large volumes of invalid traffic.

 Cross Site Scripting (XSS) is an attack where a user follows a link  that contains an embedded script. The link often looks valid, and sends the  user to a valid site. The recipient website does not contain the link that is  sent and sends a meta-refresh back to the user without validating the data it  is sent. When receiving the meta-refresh, the web browser interprets the script  as an instruction from the website and the script is executed on the user's  machine .

 In this case, when the anti-spoofing feature is enabled, all diverted  HTTP traffic is inspected and then a meta-refresh is sent to the client  containing the original request. If the original URL contains a script and a  specific character sequence, the meta-refresh from the Guard will allow the  client machine to execute the malicious script.

 Several conditions are required to be true in order for the malicious  script to be processed:

   The client user must follow a URL with a specifically formatted, embedded script to a site protected by the Guard.

   The Guard must be running active basic protection, going through basic/redirect protection.

   The specially crafted http request must be diverted through the Guard, and processed by the Guard.


Only if all of the above conditions are met will the client receive the  meta-refresh and process the embedded script.

 This vulnerability is being tracked by bug ID  CSCsf01438 ["https://bst.cloudapps.cisco.com/bugsearch/bug/CSCsf01438"]            ( registered ["https://sec.cloudapps.cisco.comRPF/register/register.do"] customers only)         .</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="6">Changing the basic/redirect protection to basic/safe-reset protects the  client from executing the embedded script. Instead of providing a layer seven  http meta-refresh to the browser with the malicious URL intact, the Guard  provides a layer three TCP-RST to end the connection. This can cause minor  compatability issues, as some firewalls do not forward the TCP-RST. However,  this method protects users from any XSS attacks until the Guard can be upgraded  to a fixed version of code.

To turn off basic/redirect and configure basic/safe-reset, please  follow the example below.


Show the zone.


user@GUARD#show zone test
 ...skipped   **** USER FILTERS **** Row Source IP Source Mask     Proto DPort Frg Action Rate Burst Units RxRate(pps) 10  *         255.255.255.255 6     80    no  basic/redirect  user@GUARD#config t user@GUARD-conf#zone test user@GUARD-conf-zone-test#no user-filter 10


Configure basic/safe-reset dynamic filter.


user@GUARD-conf-zone-test#user-filter 10 basic/safe-reset * 6 80



Show that the filter is applied.


user@GUARD#show zone test
 ...skipped   **** USER FILTERS **** Row Source IP Source Mask     Proto DPort Frg Action Rate Burst Units RxRate(pps) 10  *         255.255.255.255 6     80    no  basic/safe-reset


For more information, please refer to the configuration guide:

  http://www.cisco.com/en/US/products/ps5888/products_configuration_guide_chapter09186a00804b7d13.html#wp1135548 ["/en/US/docs/security/anomaly_detection_mitigation/appliances/guard/v5.0/configuration/guide/conffilt.html#wp1135548"]</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="7">This vulnerability is fixed in version 5.1(6) of the Cisco Anomaly  Guard code.

When considering software upgrades, also consult  http://www.cisco.com/go/psirt ["http://www.cisco.com/go/psirt"]  and any subsequent advisories to determine exposure and a complete upgrade  solution.

In all cases, customers should exercise caution to be certain the  devices to be upgraded contain sufficient memory and that current hardware and  software configurations will continue to be supported properly by the new  release. If the information is not clear, contact the Cisco Technical  Assistance Center ("TAC") or your contracted maintenance provider for  assistance.</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="8">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy ["https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="9">The Cisco PSIRT is not aware of any public announcements or malicious  use of the vulnerability described in this advisory.

This vulnerability was reported to Cisco by a customer.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference>
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20060922-understanding-xss</cvrf:URL>
      <cvrf:Description>Understanding Cross-Site Scripting (XSS) Threat Vectors</cvrf:Description>
    </cvrf:Reference>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20060920-guardxss</cvrf:URL>
      <cvrf:Description>Cisco Guard Enables Cross Site Scripting</cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Guard DDoS Mitigation Appliance" Type="Product Name">
        <FullProductName ProductID="CVRFPID-5791">Cisco Guard DDoS Mitigation Appliance </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>DO NOT PUBLISH UNTIL Sept 20 -- Cisco Guard Cross-Site Scripting Vulnerability</Title>
    <CVE>CVE-2006-4909</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-5791</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>1.9</BaseScoreV2>
        <TemporalScoreV2>1.4</TemporalScoreV2>
        <VectorV2>AV:R/AC:H/Au:NR/C:N/I:P/A:N/B:N/E:U/RL:O/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>Changing the basic/redirect protection to basic/safe-reset protects the  client from executing the embedded script. Instead of providing a layer seven  http meta-refresh to the browser with the malicious URL intact, the Guard  provides a layer three TCP-RST to end the connection. This can cause minor  compatability issues, as some firewalls do not forward the TCP-RST. However,  this method protects users from any XSS attacks until the Guard can be upgraded  to a fixed version of code.

To turn off basic/redirect and configure basic/safe-reset, please  follow the example below.


Show the zone.


user@GUARD#show zone test
 ...skipped   **** USER FILTERS **** Row Source IP Source Mask     Proto DPort Frg Action Rate Burst Units RxRate(pps) 10  *         255.255.255.255 6     80    no  basic/redirect  user@GUARD#config t user@GUARD-conf#zone test user@GUARD-conf-zone-test#no user-filter 10


Configure basic/safe-reset dynamic filter.


user@GUARD-conf-zone-test#user-filter 10 basic/safe-reset * 6 80



Show that the filter is applied.


user@GUARD#show zone test
 ...skipped   **** USER FILTERS **** Row Source IP Source Mask     Proto DPort Frg Action Rate Burst Units RxRate(pps) 10  *         255.255.255.255 6     80    no  basic/safe-reset


For more information, please refer to the configuration guide:

  http://www.cisco.com/en/US/products/ps5888/products_configuration_guide_chapter09186a00804b7d13.html#wp1135548 ["/en/US/docs/security/anomaly_detection_mitigation/appliances/guard/v5.0/configuration/guide/conffilt.html#wp1135548"]</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20060920-guardxss</URL>
        <Description>Cisco Guard Enables Cross Site Scripting</Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
