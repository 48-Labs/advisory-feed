<?xml version="1.0" encoding="UTF-8"?>
<cvrf:cvrfdoc xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:cvrf-common="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/common" xmlns:cvrf="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/cvrf">
  <cvrf:DocumentTitle>Cisco Web Security Appliance Range Request Denial of Service Vulnerability </cvrf:DocumentTitle>
  <cvrf:DocumentType>Cisco Security Advisory</cvrf:DocumentType>
  <cvrf:DocumentPublisher Type="Vendor">
    <cvrf:ContactDetails>Emergency Support:
+1 877 228 7302 (toll-free within North America)
+1 408 525 6532 (International direct-dial)
Non-emergency Support:
Email: psirt@cisco.com
Support requests that are received via e-mail are typically acknowledged within 48 hours.</cvrf:ContactDetails>
    <cvrf:IssuingAuthority>Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.
More information can be found in Cisco Security Vulnerability Policy available at https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html</cvrf:IssuingAuthority>
  </cvrf:DocumentPublisher>
  <cvrf:DocumentTracking>
    <cvrf:Identification>
      <cvrf:ID>cisco-sa-20151104-wsa2</cvrf:ID>
    </cvrf:Identification>
    <cvrf:Status>Final</cvrf:Status>
    <cvrf:Version>1.1</cvrf:Version>
    <cvrf:RevisionHistory>
      <cvrf:Revision>
        <cvrf:Number>1.0</cvrf:Number>
        <cvrf:Date>2015-11-04T15:03:04</cvrf:Date>
        <cvrf:Description>Initial public release.</cvrf:Description>
      </cvrf:Revision>
      <cvrf:Revision>
        <cvrf:Number>1.1</cvrf:Number>
        <cvrf:Date>2015-11-20T17:48:38</cvrf:Date>
        <cvrf:Description>Added steps for upgrading a device by using the GUI.</cvrf:Description>
      </cvrf:Revision>
    </cvrf:RevisionHistory>
    <cvrf:InitialReleaseDate>2015-11-04T16:00:00</cvrf:InitialReleaseDate>
    <cvrf:CurrentReleaseDate>2015-11-20T17:48:00</cvrf:CurrentReleaseDate>
    <cvrf:Generator>
      <cvrf:Engine>TVCE</cvrf:Engine>
    </cvrf:Generator>
  </cvrf:DocumentTracking>
  <cvrf:DocumentNotes>
    <cvrf:Note Title="Summary" Type="Summary" Ordinal="1">A vulnerability in the file-range request functionality of Cisco AsyncOS for Cisco Web Security Appliance (WSA) could allow an unauthenticated, remote attacker to cause a denial of service (DoS) condition on an appliance because the appliance runs out of system memory.



The vulnerability is due to a failure to free memory when a file range is requested through the Cisco WSA. An attacker could exploit this vulnerability by opening multiple connections that request file ranges through the WSA. A successful exploit could allow the attacker to cause the WSA to stop passing traffic when enough memory is used and not freed.



Cisco has released software updates that address this vulnerability. A workaround that mitigates this vulnerability is also available.



This advisory is available at the following link:



 https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa2["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa2"]</cvrf:Note>
    <cvrf:Note Title="Vulnerable Products" Type="General" Ordinal="2">This vulnerability affects Cisco AsyncOS versions 8.0 through 8.8 for Cisco WSA on both virtual and hardware appliances.


To determine whether a vulnerable version of Cisco AsyncOS Software is running on a Cisco WSA, administrators can use the version command in the WSA CLI. The following example shows the results for an appliance running Cisco AsyncOS Software version 8.5.3-051:


ciscowsa&gt; version
Current Version
===============
Product: Cisco IronPort S670 Web Security Appliance
Model: S670
Version: 8.5.3-051
.
.
.


See the "Fixed Software" section of this security advisory for more information about the affected versions.</cvrf:Note>
    <cvrf:Note Title="Products Confirmed Not Vulnerable" Type="General" Ordinal="3">The following products are not affected by this vulnerability:


    Cisco Email Security Appliance (ESA), both virtual and hardware versions
    Cisco Security Mail Appliance (SMA), both virtual and hardware versions



No other Cisco products are currently known to be affected by this vulnerability.</cvrf:Note>
    <cvrf:Note Title="Indicators of Compromise" Type="General" Ordinal="4">The indicator of compromise for this vulnerability is an accumulation of TCP connections that are not freed, which can lead to memory exhaustion. To determine whether there is an accumulation of connections, use the status detail command in the Cisco WSA CLI. The value of the Total client connections field may show a large number of connections, as shown in the following example:


# status detail
Connections:
  Total client connections                   99999


If this condition is observed, the appliance may have been compromised by this vulnerability. In addition, any indication of memory exhaustion should be examined because this vulnerability is a memory leak.</cvrf:Note>
    <cvrf:Note Title="Workarounds" Type="General" Ordinal="5">If the results of using the status detail command in the Cisco WSA CLI indicate an accumulation of TCP connections, as described in the "Indicators of Compromise" section, use the hidden diagnostic -&gt; PROXY -&gt; KICK  command to restart the proxy process and reclaim memory.
</cvrf:Note>
    <cvrf:Note Title="Fixed Software" Type="General" Ordinal="6">When considering software upgrades, customers are advised to consult the Cisco Security Advisories and Responses archive at http://www.cisco.com/go/psirt["http://www.cisco.com/go/psirt"] and review subsequent advisories to determine exposure and a complete upgrade solution.



In all cases, customers should ensure that the devices to upgrade contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.



In the following table, the left column lists major releases of Cisco AsyncOS Software for Cisco WSA. The center column indicates whether a major release is affected by the vulnerability described in this advisory and the first minor release that includes the fix for this vulnerability. The right column indicates whether a major release is affected by all the vulnerabilities described in this and the following companion advisories and which release includes fixes for those vulnerabilities:


    cisco-sa-20151104-aos["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-aos"]
    cisco-sa-20150612-esa["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20150612-esa"]
    cisco-sa-20151104-esa2["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-esa2"]
    cisco-sa-20151104-wsa["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa"]
    cisco-sa-20151104-wsa1["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa1"]
    cisco-sa-20151104-wsa2["https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa2"]



Customers should upgrade to an appropriate release  as indicated in the following table:




    
        
            AsyncOS for WSA

            Major Release
            
            First Fixed Release for

            This Vulnerability
            
            First Fixed Release for

            This Vulnerability and

            All Vulnerabilities Described in the

            Companion Advisories
            
        
        
            7.5 and prior

            
            Not affected
            
            7.7.0-761 or later

            
        
        
            7.7

            
            Not affected

            
            7.7.0-761 or later

            
        
        
            8.0
            8.0.8-113
            8.0.8-113 or later
        
        
            8.1
            Affected; migrate to 8.5.3-051
            Affected; migrate to 8.5.3-051 or later
        
        
            8.5
            8.5.3-051
            8.5.3-051 or later
        
        
            8.6
            Affected; migrate to 8.7.0-171-LD
            Affected; migrate to 8.7.0-171-LD or later
        
        
            8.7
            8.7.0-171-LD
            8.7.0-171-LD or later
        
        
            8.8
            8.8.0-085
            8.8.0-085 or later
        
        
            9.0
            Not affected
            Not affected
        
    



In most cases a WSA can be updated over the network by using the System Upgrade options in the System Administration GUI. To upgrade a device by using the System Administration GUI:


    Choose System Administration &gt; System Upgrade.
    Click Upgrade Options.
    Choose the option to Download and Install or, for an ESA, Download the upgrade.
    Choose the release to upgrade to.
    In the Upgrade Preparation area, choose the appropriate options.
    Click Proceed to begin the upgrade. A progress bar displays the status of the upgrade.

After the upgrade is complete, the device reboots.
</cvrf:Note>
    <cvrf:Note Title="Vulnerability Policy" Type="General" Ordinal="7">To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy[https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.</cvrf:Note>
    <cvrf:Note Title="Exploitation and Public Announcements" Type="General" Ordinal="8">The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.</cvrf:Note>
    <cvrf:Note Title="Source" Type="General" Ordinal="9">This vulnerability was found during the resolution of a support case.</cvrf:Note>
    <cvrf:Note Title="Legal Disclaimer" Type="Legal Disclaimer" Ordinal="10">THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.

A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.
</cvrf:Note>
  </cvrf:DocumentNotes>
  <cvrf:DocumentReferences>
    <cvrf:Reference Type="Self">
      <cvrf:URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa2</cvrf:URL>
      <cvrf:Description>Cisco Web Security Appliance Range Request Denial of Service Vulnerability </cvrf:Description>
    </cvrf:Reference>
  </cvrf:DocumentReferences>
  <ProductTree xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/prod">
    <Branch Name="Cisco" Type="Vendor">
      <Branch Name="Cisco Web Security Appliance (WSA)" Type="Product Name">
        <FullProductName ProductID="CVRFPID-189789">Cisco Web Security Appliance (WSA) </FullProductName>
      </Branch>
    </Branch>
  </ProductTree>
  <Vulnerability Ordinal="1" xmlns="http://docs.oasis-open.org/csaf/ns/csaf-cvrf/v1.2/vuln">
    <Title>Cisco Web Security Appliance Range Request Denial of Service Vulnerability</Title>
    <ID SystemName="Cisco Bug ID">CSCur39155</ID>
    <Notes>
      <Note Title="Cisco Bug IDs" Type="Other" Ordinal="1">CSCur39155,CSCuu29304</Note>
      <Note Title="Affected Product Comprehensiveness" Type="Other" Ordinal="2">Complete.</Note>
    </Notes>
    <CVE>CVE-2015-6293</CVE>
    <ProductStatuses>
      <Status Type="Known Affected">
        <ProductID>CVRFPID-189789</ProductID>
      </Status>
    </ProductStatuses>
    <CVSSScoreSets>
      <ScoreSetV2>
        <BaseScoreV2>7.8</BaseScoreV2>
        <TemporalScoreV2>6.4</TemporalScoreV2>
        <VectorV2>AV:N/AC:L/Au:N/C:N/I:N/A:C/E:F/RL:OF/RC:C</VectorV2>
      </ScoreSetV2>
    </CVSSScoreSets>
    <Remediations>
      <Remediation Type="Workaround">
        <Description>If the results of using the status detail command in the Cisco WSA CLI indicate an accumulation of TCP connections, as described in the "Indicators of Compromise" section, use the hidden diagnostic -&gt; PROXY -&gt; KICK  command to restart the proxy process and reclaim memory.
</Description>
      </Remediation>
    </Remediations>
    <References>
      <Reference Type="Self">
        <URL>https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20151104-wsa2</URL>
        <Description>Cisco Web Security Appliance Range Request Denial of Service Vulnerability </Description>
      </Reference>
    </References>
  </Vulnerability>
</cvrf:cvrfdoc>
